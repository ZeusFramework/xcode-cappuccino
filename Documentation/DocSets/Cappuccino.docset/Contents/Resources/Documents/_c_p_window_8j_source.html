<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Cappuccino: AppKit/CPWindow/CPWindow.j Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>AppKit/CPWindow/CPWindow.j</h1><a href="_c_p_window_8j.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * CPWindow.j</span>
<a name="l00003"></a>00003 <span class="comment"> * AppKit</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * Created by Francisco Tolmasky.</span>
<a name="l00006"></a>00006 <span class="comment"> * Copyright 2008, 280 North, Inc.</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * This library is free software; you can redistribute it and/or</span>
<a name="l00009"></a>00009 <span class="comment"> * modify it under the terms of the GNU Lesser General Public</span>
<a name="l00010"></a>00010 <span class="comment"> * License as published by the Free Software Foundation; either</span>
<a name="l00011"></a>00011 <span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> * This library is distributed in the hope that it will be useful,</span>
<a name="l00014"></a>00014 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00015"></a>00015 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span>
<a name="l00016"></a>00016 <span class="comment"> * Lesser General Public License for more details.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * You should have received a copy of the GNU Lesser General Public</span>
<a name="l00019"></a>00019 <span class="comment"> * License along with this library; if not, write to the Free Software</span>
<a name="l00020"></a>00020 <span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 @<span class="keyword">import</span> &lt;Foundation/<a class="code" href="class_c_p_counted_set.html" title="An mutable collection which may contain a specific object numerous times.">CPCountedSet</a>.j&gt;
<a name="l00024"></a>00024 @<span class="keyword">import</span> &lt;Foundation/<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a>.j&gt;
<a name="l00025"></a>00025 @<span class="keyword">import</span> &lt;Foundation/<a class="code" href="class_c_p_undo_manager.html" title="A general mechanism for user action &amp;quot;undo&amp;quot;.">CPUndoManager</a>.j&gt;
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 @<span class="keyword">import</span> <span class="stringliteral">&quot;CGGeometry.j&quot;</span>
<a name="l00028"></a>00028 @<span class="keyword">import</span> <span class="stringliteral">&quot;CPAnimation.j&quot;</span>
<a name="l00029"></a>00029 @<span class="keyword">import</span> <span class="stringliteral">&quot;CPResponder.j&quot;</span>
<a name="l00030"></a>00030 @<span class="keyword">import</span> <span class="stringliteral">&quot;CPScreen.j&quot;</span>
<a name="l00031"></a>00031 @<span class="keyword">import</span> <span class="stringliteral">&quot;CPPlatformWindow.j&quot;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;../Platform/Platform.h&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;../Platform/DOM/CPDOMDisplayServer.h&quot;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;../CoreGraphics/CGGeometry.h&quot;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="comment">/*</span>
<a name="l00040"></a>00040 <span class="comment">    Borderless window mask option.</span>
<a name="l00041"></a>00041 <span class="comment">    @global</span>
<a name="l00042"></a>00042 <span class="comment">    @class CPWindow</span>
<a name="l00043"></a>00043 <span class="comment">*/</span>
<a name="l00044"></a><a class="code" href="_c_p_window_8j.html#a98f5b5b410df12afdd80828a544f029b">00044</a> <a class="code" href="_c_p_window_8j.html#a98f5b5b410df12afdd80828a544f029b">CPBorderlessWindowMask</a>          = 0;
<a name="l00045"></a>00045 <span class="comment">/*</span>
<a name="l00046"></a>00046 <span class="comment">    Titled window mask option.</span>
<a name="l00047"></a>00047 <span class="comment">    @global</span>
<a name="l00048"></a>00048 <span class="comment">    @class CPWindow</span>
<a name="l00049"></a>00049 <span class="comment">*/</span>
<a name="l00050"></a><a class="code" href="_c_p_window_8j.html#a92c73c5656c71cb11b666a223cce8021">00050</a> <a class="code" href="_c_p_window_8j.html#a92c73c5656c71cb11b666a223cce8021">CPTitledWindowMask</a>              = 1 &lt;&lt; 0;
<a name="l00051"></a>00051 <span class="comment">/*</span>
<a name="l00052"></a>00052 <span class="comment">    Closeable window mask option.</span>
<a name="l00053"></a>00053 <span class="comment">    @global</span>
<a name="l00054"></a>00054 <span class="comment">    @class CPWindow</span>
<a name="l00055"></a>00055 <span class="comment">*/</span>
<a name="l00056"></a><a class="code" href="_c_p_window_8j.html#a023fc2836418fce3604d586d875d2506">00056</a> <a class="code" href="_c_p_window_8j.html#a023fc2836418fce3604d586d875d2506">CPClosableWindowMask</a>            = 1 &lt;&lt; 1;
<a name="l00057"></a>00057 <span class="comment">/*</span>
<a name="l00058"></a>00058 <span class="comment">    Miniaturizabe window mask option.</span>
<a name="l00059"></a>00059 <span class="comment">    @global</span>
<a name="l00060"></a>00060 <span class="comment">    @class CPWindow</span>
<a name="l00061"></a>00061 <span class="comment">*/</span>
<a name="l00062"></a><a class="code" href="_c_p_window_8j.html#ab4bbfb463e32bdd316c00412cccab509">00062</a> <a class="code" href="_c_p_window_8j.html#ab4bbfb463e32bdd316c00412cccab509">CPMiniaturizableWindowMask</a>      = 1 &lt;&lt; 2;
<a name="l00063"></a>00063 <span class="comment">/*</span>
<a name="l00064"></a>00064 <span class="comment">    Resizable window mask option.</span>
<a name="l00065"></a>00065 <span class="comment">    @global</span>
<a name="l00066"></a>00066 <span class="comment">    @class CPWindow</span>
<a name="l00067"></a>00067 <span class="comment">*/</span>
<a name="l00068"></a><a class="code" href="_c_p_window_8j.html#ae2c737a199d2ec0ea9c8547aae2d0a18">00068</a> <a class="code" href="_c_p_window_8j.html#ae2c737a199d2ec0ea9c8547aae2d0a18">CPResizableWindowMask</a>           = 1 &lt;&lt; 3;
<a name="l00069"></a>00069 <span class="comment">/*</span>
<a name="l00070"></a>00070 <span class="comment">    Textured window mask option.</span>
<a name="l00071"></a>00071 <span class="comment">    @global</span>
<a name="l00072"></a>00072 <span class="comment">    @class CPWindow</span>
<a name="l00073"></a>00073 <span class="comment">*/</span>
<a name="l00074"></a><a class="code" href="_c_p_window_8j.html#ae156c52ff5596e85b50900c559268fe1">00074</a> <a class="code" href="_c_p_window_8j.html#ae156c52ff5596e85b50900c559268fe1">CPTexturedBackgroundWindowMask</a>  = 1 &lt;&lt; 8;
<a name="l00075"></a>00075 <span class="comment">/*</span>
<a name="l00076"></a>00076 <span class="comment">    @global</span>
<a name="l00077"></a>00077 <span class="comment">    @class CPWindow</span>
<a name="l00078"></a>00078 <span class="comment">*/</span>
<a name="l00079"></a><a class="code" href="_c_p_window_8j.html#ab9cb38d9cbdffe2bab2f10a4688545bd">00079</a> <a class="code" href="_c_p_window_8j.html#ab9cb38d9cbdffe2bab2f10a4688545bd">CPBorderlessBridgeWindowMask</a>    = 1 &lt;&lt; 20;
<a name="l00080"></a>00080 <span class="comment">/*</span>
<a name="l00081"></a>00081 <span class="comment">    @global</span>
<a name="l00082"></a>00082 <span class="comment">    @class CPWindow</span>
<a name="l00083"></a>00083 <span class="comment">*/</span>
<a name="l00084"></a><a class="code" href="_c_p_window_8j.html#a550358819a66f387034d69aef39cc480">00084</a> <a class="code" href="_c_p_window_8j.html#a550358819a66f387034d69aef39cc480">CPHUDBackgroundWindowMask</a>       = 1 &lt;&lt; 21;
<a name="l00085"></a>00085 
<a name="l00086"></a><a class="code" href="_c_p_window_8j.html#a556155bbdc19382299b5ef083560284b">00086</a> <a class="code" href="_c_p_window_8j.html#a556155bbdc19382299b5ef083560284b">CPWindowNotSizable</a>              = 0;
<a name="l00087"></a><a class="code" href="_c_p_window_8j.html#a9f8c18b9026cebcb2a1f8f91a01d5685">00087</a> <a class="code" href="_c_p_window_8j.html#a9f8c18b9026cebcb2a1f8f91a01d5685">CPWindowMinXMargin</a>              = 1;
<a name="l00088"></a><a class="code" href="_c_p_window_8j.html#a00f963c2ad31d2392edc1061592e1868">00088</a> <a class="code" href="_c_p_window_8j.html#a00f963c2ad31d2392edc1061592e1868">CPWindowWidthSizable</a>            = 2;
<a name="l00089"></a><a class="code" href="_c_p_window_8j.html#aa334d7b21d635b43f2e0a3ed993c19dd">00089</a> <a class="code" href="_c_p_window_8j.html#aa334d7b21d635b43f2e0a3ed993c19dd">CPWindowMaxXMargin</a>              = 4;
<a name="l00090"></a><a class="code" href="_c_p_window_8j.html#a602a019923a512326b42022289ca5238">00090</a> <a class="code" href="_c_p_window_8j.html#a602a019923a512326b42022289ca5238">CPWindowMinYMargin</a>              = 8;
<a name="l00091"></a><a class="code" href="_c_p_window_8j.html#ad1bc138bdcf0c5b9690c8b1508c49f43">00091</a> <a class="code" href="_c_p_window_8j.html#ad1bc138bdcf0c5b9690c8b1508c49f43">CPWindowHeightSizable</a>           = 16;
<a name="l00092"></a><a class="code" href="_c_p_window_8j.html#a46ec4bd30fada9b12a2cc412b40e7f07">00092</a> <a class="code" href="_c_p_window_8j.html#a46ec4bd30fada9b12a2cc412b40e7f07">CPWindowMaxYMargin</a>              = 32;
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="_c_p_window_8j.html#a68f8f77265c354bf1b55367ffe54c55a">00094</a> <a class="code" href="_c_p_window_8j.html#a68f8f77265c354bf1b55367ffe54c55a">CPBackgroundWindowLevel</a>         = -1;
<a name="l00095"></a>00095 <span class="comment">/*</span>
<a name="l00096"></a>00096 <span class="comment">    Default level for windows</span>
<a name="l00097"></a>00097 <span class="comment">    @group CPWindowLevel</span>
<a name="l00098"></a>00098 <span class="comment">    @global</span>
<a name="l00099"></a>00099 <span class="comment">*/</span>
<a name="l00100"></a><a class="code" href="_c_p_window_8j.html#af8c6804a600c65ea9e35419a2b807bd2">00100</a> <a class="code" href="_c_p_window_8j.html#af8c6804a600c65ea9e35419a2b807bd2">CPNormalWindowLevel</a>             = 0;
<a name="l00101"></a>00101 <span class="comment">/*</span>
<a name="l00102"></a>00102 <span class="comment">    Floating palette type window</span>
<a name="l00103"></a>00103 <span class="comment">    @group CPWindowLevel</span>
<a name="l00104"></a>00104 <span class="comment">    @global</span>
<a name="l00105"></a>00105 <span class="comment">*/</span>
<a name="l00106"></a><a class="code" href="_c_p_window_8j.html#a4cb5a0c60fcdbd75361768248b326748">00106</a> <a class="code" href="_c_p_window_8j.html#a4cb5a0c60fcdbd75361768248b326748">CPFloatingWindowLevel</a>           = 3;
<a name="l00107"></a>00107 <span class="comment">/*</span>
<a name="l00108"></a>00108 <span class="comment">    Submenu type window</span>
<a name="l00109"></a>00109 <span class="comment">    @group CPWindowLevel</span>
<a name="l00110"></a>00110 <span class="comment">    @global</span>
<a name="l00111"></a>00111 <span class="comment">*/</span>
<a name="l00112"></a><a class="code" href="_c_p_window_8j.html#a46e6fa028d8a9216dc3e5d5543a27b25">00112</a> <a class="code" href="_c_p_window_8j.html#a46e6fa028d8a9216dc3e5d5543a27b25">CPSubmenuWindowLevel</a>            = 3;
<a name="l00113"></a>00113 <span class="comment">/*</span>
<a name="l00114"></a>00114 <span class="comment">    For a torn-off menu</span>
<a name="l00115"></a>00115 <span class="comment">    @group CPWindowLevel</span>
<a name="l00116"></a>00116 <span class="comment">    @global</span>
<a name="l00117"></a>00117 <span class="comment">*/</span>
<a name="l00118"></a><a class="code" href="_c_p_window_8j.html#a01620b795ed6bf08f4e7f0eb74f28226">00118</a> <a class="code" href="_c_p_window_8j.html#a01620b795ed6bf08f4e7f0eb74f28226">CPTornOffMenuWindowLevel</a>        = 3;
<a name="l00119"></a>00119 <span class="comment">/*</span>
<a name="l00120"></a>00120 <span class="comment">    For the application&#39;s main menu</span>
<a name="l00121"></a>00121 <span class="comment">    @group CPWindowLevel</span>
<a name="l00122"></a>00122 <span class="comment">    @global</span>
<a name="l00123"></a>00123 <span class="comment">*/</span>
<a name="l00124"></a><a class="code" href="_c_p_window_8j.html#a8d39ce99d5f37a67647c5d9367e3f364">00124</a> <a class="code" href="_c_p_window_8j.html#a8d39ce99d5f37a67647c5d9367e3f364">CPMainMenuWindowLevel</a>           = 24;
<a name="l00125"></a>00125 <span class="comment">/*</span>
<a name="l00126"></a>00126 <span class="comment">    Status window level</span>
<a name="l00127"></a>00127 <span class="comment">    @group CPWindowLevel</span>
<a name="l00128"></a>00128 <span class="comment">    @global</span>
<a name="l00129"></a>00129 <span class="comment">*/</span>
<a name="l00130"></a><a class="code" href="_c_p_window_8j.html#a1dfc36bdc9611885eb23d532e022c27f">00130</a> <a class="code" href="_c_p_window_8j.html#a1dfc36bdc9611885eb23d532e022c27f">CPStatusWindowLevel</a>             = 25;
<a name="l00131"></a>00131 <span class="comment">/*</span>
<a name="l00132"></a>00132 <span class="comment">    Level for a modal panel</span>
<a name="l00133"></a>00133 <span class="comment">    @group CPWindowLevel</span>
<a name="l00134"></a>00134 <span class="comment">    @global</span>
<a name="l00135"></a>00135 <span class="comment">*/</span>
<a name="l00136"></a><a class="code" href="_c_p_window_8j.html#a4dbf5de3216100779b5cbad2a78bc916">00136</a> <a class="code" href="_c_p_window_8j.html#a4dbf5de3216100779b5cbad2a78bc916">CPModalPanelWindowLevel</a>         = 8;
<a name="l00137"></a>00137 <span class="comment">/*</span>
<a name="l00138"></a>00138 <span class="comment">    Level for a pop up menu</span>
<a name="l00139"></a>00139 <span class="comment">    @group CPWindowLevel</span>
<a name="l00140"></a>00140 <span class="comment">    @global</span>
<a name="l00141"></a>00141 <span class="comment">*/</span>
<a name="l00142"></a><a class="code" href="_c_p_window_8j.html#ae910f11b4d4d301f08eef61e5f2732ea">00142</a> <a class="code" href="_c_p_window_8j.html#ae910f11b4d4d301f08eef61e5f2732ea">CPPopUpMenuWindowLevel</a>          = 101;
<a name="l00143"></a>00143 <span class="comment">/*</span>
<a name="l00144"></a>00144 <span class="comment">    Level for a window being dragged</span>
<a name="l00145"></a>00145 <span class="comment">    @group CPWindowLevel</span>
<a name="l00146"></a>00146 <span class="comment">    @global</span>
<a name="l00147"></a>00147 <span class="comment">*/</span>
<a name="l00148"></a><a class="code" href="_c_p_window_8j.html#a3018c94066c61cc16967f8807a5d3632">00148</a> <a class="code" href="_c_p_window_8j.html#a3018c94066c61cc16967f8807a5d3632">CPDraggingWindowLevel</a>           = 500;
<a name="l00149"></a>00149 <span class="comment">/*</span>
<a name="l00150"></a>00150 <span class="comment">    Level for the screens saver</span>
<a name="l00151"></a>00151 <span class="comment">    @group CPWindowLevel</span>
<a name="l00152"></a>00152 <span class="comment">    @global</span>
<a name="l00153"></a>00153 <span class="comment">*/</span>
<a name="l00154"></a><a class="code" href="_c_p_window_8j.html#a072b901310711ca455fb39ba5c22ad03">00154</a> <a class="code" href="_c_p_window_8j.html#a072b901310711ca455fb39ba5c22ad03">CPScreenSaverWindowLevel</a>        = 1000;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 <span class="comment">/*</span>
<a name="l00157"></a>00157 <span class="comment">    The receiver is removed from the screen list and hidden.</span>
<a name="l00158"></a>00158 <span class="comment">    @global</span>
<a name="l00159"></a>00159 <span class="comment">    @class CPWindowOrderingMode</span>
<a name="l00160"></a>00160 <span class="comment">*/</span>
<a name="l00161"></a><a class="code" href="_c_p_window_8j.html#a4eeba0f56fd2d0fd8239c14d4fb86029">00161</a> <a class="code" href="_c_p_window_8j.html#a4eeba0f56fd2d0fd8239c14d4fb86029">CPWindowOut</a>                     = 0;
<a name="l00162"></a>00162 <span class="comment">/*</span>
<a name="l00163"></a>00163 <span class="comment">    The receiver is placed directly in front of the window specified.</span>
<a name="l00164"></a>00164 <span class="comment">    @global</span>
<a name="l00165"></a>00165 <span class="comment">    @class CPWindowOrderingMode</span>
<a name="l00166"></a>00166 <span class="comment">*/</span>
<a name="l00167"></a><a class="code" href="_c_p_window_8j.html#a32733797329818bbb85b9838bbf0fa26">00167</a> <a class="code" href="_c_p_window_8j.html#a32733797329818bbb85b9838bbf0fa26">CPWindowAbove</a>                   = 1;
<a name="l00168"></a>00168 <span class="comment">/*</span>
<a name="l00169"></a>00169 <span class="comment">    The receiver is placed directly behind the window specified.</span>
<a name="l00170"></a>00170 <span class="comment">    @global</span>
<a name="l00171"></a>00171 <span class="comment">    @class CPWindowOrderingMode</span>
<a name="l00172"></a>00172 <span class="comment">*/</span>
<a name="l00173"></a><a class="code" href="_c_p_window_8j.html#a1335df5162b142d7648d2c2ac3d85e37">00173</a> <a class="code" href="_c_p_window_8j.html#a1335df5162b142d7648d2c2ac3d85e37">CPWindowBelow</a>                   = 2;
<a name="l00174"></a>00174 
<a name="l00175"></a><a class="code" href="_c_p_window_8j.html#a735ba3c488f8ed97989326775e3e6212">00175</a> <a class="code" href="_c_p_window_8j.html#a735ba3c488f8ed97989326775e3e6212">CPWindowWillCloseNotification</a>       = <span class="stringliteral">@&quot;CPWindowWillCloseNotification&quot;</span>;
<a name="l00176"></a><a class="code" href="_c_p_window_8j.html#a1f86d11c0903bf469a30c5c739fefa00">00176</a> <a class="code" href="_c_p_window_8j.html#a1f86d11c0903bf469a30c5c739fefa00">CPWindowDidBecomeMainNotification</a>   = <span class="stringliteral">@&quot;CPWindowDidBecomeMainNotification&quot;</span>;
<a name="l00177"></a><a class="code" href="_c_p_window_8j.html#aac3a49b86a2a33863f579d092caec66d">00177</a> <a class="code" href="_c_p_window_8j.html#aac3a49b86a2a33863f579d092caec66d">CPWindowDidResignMainNotification</a>   = <span class="stringliteral">@&quot;CPWindowDidResignMainNotification&quot;</span>;
<a name="l00178"></a><a class="code" href="_c_p_window_8j.html#a79bc099d8c07cfc6b70302521739e687">00178</a> <a class="code" href="_c_p_window_8j.html#a79bc099d8c07cfc6b70302521739e687">CPWindowDidResizeNotification</a>       = <span class="stringliteral">@&quot;CPWindowDidResizeNotification&quot;</span>;
<a name="l00179"></a><a class="code" href="_c_p_window_8j.html#ab9e5d430bf9a3ca191d537acba2f5848">00179</a> <a class="code" href="_c_p_window_8j.html#ab9e5d430bf9a3ca191d537acba2f5848">CPWindowDidMoveNotification</a>         = <span class="stringliteral">@&quot;CPWindowDidMoveNotification&quot;</span>;
<a name="l00180"></a><a class="code" href="_c_p_window_8j.html#a18a309ccb085d17d619b08eebb79c55b">00180</a> <a class="code" href="_c_p_window_8j.html#a18a309ccb085d17d619b08eebb79c55b">CPWindowWillBeginSheetNotification</a>  = <span class="stringliteral">@&quot;CPWindowWillBeginSheetNotification&quot;</span>;
<a name="l00181"></a><a class="code" href="_c_p_window_8j.html#adf43f8ba8eeb80ae24cb5f1597b02667">00181</a> <a class="code" href="_c_p_window_8j.html#adf43f8ba8eeb80ae24cb5f1597b02667">CPWindowDidEndSheetNotification</a>     = <span class="stringliteral">@&quot;CPWindowDidEndSheetNotification&quot;</span>;
<a name="l00182"></a><a class="code" href="_c_p_window_8j.html#af4d47f0cdc723d79e67566c288471d71">00182</a> <a class="code" href="_c_p_window_8j.html#af4d47f0cdc723d79e67566c288471d71">CPWindowDidMiniaturizeNotification</a>  = <span class="stringliteral">@&quot;CPWindowDidMiniaturizeNotification&quot;</span>;
<a name="l00183"></a><a class="code" href="_c_p_window_8j.html#aecca62ad4e9926b633453265e232ec45">00183</a> <a class="code" href="_c_p_window_8j.html#aecca62ad4e9926b633453265e232ec45">CPWindowWillMiniaturizeNotification</a> = <span class="stringliteral">@&quot;CPWindowWillMiniaturizeNotification&quot;</span>;
<a name="l00184"></a><a class="code" href="_c_p_window_8j.html#addebc8dc8e3f07d1bd6edc5209dee66d">00184</a> <a class="code" href="_c_p_window_8j.html#addebc8dc8e3f07d1bd6edc5209dee66d">CPWindowDidDeminiaturizeNotification</a> = <span class="stringliteral">@&quot;CPWindowDidDeminiaturizeNotification&quot;</span>;
<a name="l00185"></a>00185 
<a name="l00186"></a><a class="code" href="_c_p_window_8j.html#a0bf748dddc25f01333318b3d712b5e7c">00186</a> <a class="code" href="_c_p_window_8j.html#a0bf748dddc25f01333318b3d712b5e7c">CPWindowShadowStyleStandard</a> = 0;
<a name="l00187"></a><a class="code" href="_c_p_window_8j.html#a3e83c7f663fb9246872ce7122957dce1">00187</a> <a class="code" href="_c_p_window_8j.html#a3e83c7f663fb9246872ce7122957dce1">CPWindowShadowStyleMenu</a>     = 1;
<a name="l00188"></a><a class="code" href="_c_p_window_8j.html#a3fb4d9fa71c2dc28191300f69ade55dc">00188</a> <a class="code" href="_c_p_window_8j.html#a3fb4d9fa71c2dc28191300f69ade55dc">CPWindowShadowStylePanel</a>    = 2;
<a name="l00189"></a>00189 
<a name="l00190"></a><a class="code" href="_c_p_window_8j.html#aa42ad6b1a46744bb41057135d82e2794">00190</a> var <a class="code" href="_c_p_window_8j.html#aa42ad6b1a46744bb41057135d82e2794">SHADOW_MARGIN_LEFT</a>      = 20.0,
<a name="l00191"></a><a class="code" href="_c_p_window_8j.html#af4a32c7f1961957237011c6b4c8b5224">00191</a>     <a class="code" href="_c_p_window_8j.html#af4a32c7f1961957237011c6b4c8b5224">SHADOW_MARGIN_RIGHT</a>     = 19.0,
<a name="l00192"></a><a class="code" href="_c_p_window_8j.html#acd7267d5eb2d409f053b7c21271978d0">00192</a>     <a class="code" href="_c_p_window_8j.html#acd7267d5eb2d409f053b7c21271978d0">SHADOW_MARGIN_TOP</a>       = 10.0,
<a name="l00193"></a><a class="code" href="_c_p_window_8j.html#a30d79bcfce90679ea6720242c787a2a0">00193</a>     <a class="code" href="_c_p_window_8j.html#a30d79bcfce90679ea6720242c787a2a0">SHADOW_MARGIN_BOTTOM</a>    = 10.0,
<a name="l00194"></a><a class="code" href="_c_p_window_8j.html#ae410937f407d814e4a06b902dc29001a">00194</a>     <a class="code" href="_c_p_window_8j.html#ae410937f407d814e4a06b902dc29001a">SHADOW_DISTANCE</a>         = 5.0,
<a name="l00195"></a>00195     
<a name="l00196"></a>00196     _CPWindowShadowColor    = nil;
<a name="l00197"></a>00197     
<a name="l00198"></a><a class="code" href="_c_p_window_8j.html#a51cefe6c4b9ce4b6f5f00509636cc76b">00198</a> var <a class="code" href="_c_p_window_8j.html#a51cefe6c4b9ce4b6f5f00509636cc76b">CPWindowSaveImage</a>       = nil,
<a name="l00199"></a><a class="code" href="_c_p_window_8j.html#a1cedf05cfa18440686df5fd4e2d62e74">00199</a>     <a class="code" href="_c_p_window_8j.html#a1cedf05cfa18440686df5fd4e2d62e74">CPWindowSavingImage</a>     = nil;
<a name="l00200"></a>00200 
<a name="l00247"></a>00247 <span class="keyword">@implementation </span><a class="code" href="class_c_p_window.html">CPWindow</a> : <a class="code" href="class_c_p_responder.html">CPResponder</a>
<a name="l00248"></a>00248 {
<a name="l00249"></a>00249     <a class="code" href="class_c_p_platform_window.html">CPPlatformWindow</a>                    _platformWindow;
<a name="l00250"></a>00250 
<a name="l00251"></a>00251     <span class="keywordtype">int</span>                                 _windowNumber;
<a name="l00252"></a>00252     <span class="keywordtype">unsigned</span>                            _styleMask;
<a name="l00253"></a>00253     CGRect                              _frame;
<a name="l00254"></a>00254     <span class="keywordtype">int</span>                                 _level;
<a name="l00255"></a>00255     BOOL                                _isVisible;
<a name="l00256"></a>00256     BOOL                                _isMiniaturized;
<a name="l00257"></a>00257     BOOL                                _isAnimating;
<a name="l00258"></a>00258     BOOL                                _hasShadow;
<a name="l00259"></a>00259     BOOL                                _isMovableByWindowBackground;
<a name="l00260"></a>00260     <span class="keywordtype">unsigned</span>                            _shadowStyle;
<a name="l00261"></a>00261     BOOL                                _showsResizeIndicator;
<a name="l00262"></a>00262 
<a name="l00263"></a>00263     BOOL                                _isDocumentEdited;
<a name="l00264"></a>00264     BOOL                                _isDocumentSaving;
<a name="l00265"></a>00265 
<a name="l00266"></a>00266     <a class="code" href="class_c_p_image_view.html">CPImageView</a>                         _shadowView;
<a name="l00267"></a>00267 
<a name="l00268"></a>00268     <a class="code" href="class_c_p_view.html">CPView</a>                              _windowView;
<a name="l00269"></a>00269     <a class="code" href="class_c_p_view.html">CPView</a>                              _contentView;
<a name="l00270"></a>00270     <a class="code" href="class_c_p_view.html">CPView</a>                              _toolbarView;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     <a class="code" href="class_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript...">CPArray</a>                             _mouseEnteredStack;
<a name="l00273"></a>00273     <a class="code" href="class_c_p_view.html">CPView</a>                              _leftMouseDownView;
<a name="l00274"></a>00274     <a class="code" href="class_c_p_view.html">CPView</a>                              _rightMouseDownView;
<a name="l00275"></a>00275 
<a name="l00276"></a>00276     <a class="code" href="class_c_p_toolbar.html">CPToolbar</a>                           _toolbar;
<a name="l00277"></a>00277     <a class="code" href="class_c_p_responder.html">CPResponder</a>                         _firstResponder;
<a name="l00278"></a>00278     <a class="code" href="class_c_p_responder.html">CPResponder</a>                         _initialFirstResponder;
<a name="l00279"></a>00279     <span class="keywordtype">id</span>                                  _delegate;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281     <a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>                            _title;
<a name="l00282"></a>00282 
<a name="l00283"></a>00283     BOOL                                _acceptsMouseMovedEvents;
<a name="l00284"></a>00284     BOOL                                _ignoresMouseEvents;
<a name="l00285"></a>00285 
<a name="l00286"></a>00286     <a class="code" href="class_c_p_window_controller.html">CPWindowController</a>                  _windowController;
<a name="l00287"></a>00287 
<a name="l00288"></a>00288     CGSize                              _minSize;
<a name="l00289"></a>00289     CGSize                              _maxSize;
<a name="l00290"></a>00290 
<a name="l00291"></a>00291     <a class="code" href="class_c_p_undo_manager.html" title="A general mechanism for user action &amp;quot;undo&amp;quot;.">CPUndoManager</a>                       _undoManager;
<a name="l00292"></a>00292     <a class="code" href="class_c_p_u_r_l.html">CPURL</a>                               _representedURL;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294     <a class="code" href="class_c_p_set.html" title="An unordered collection of objects.">CPSet</a>                               _registeredDraggedTypes;
<a name="l00295"></a>00295     <a class="code" href="class_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript...">CPArray</a>                             _registeredDraggedTypesArray;
<a name="l00296"></a>00296     <a class="code" href="class_c_p_counted_set.html" title="An mutable collection which may contain a specific object numerous times.">CPCountedSet</a>                        _inclusiveRegisteredDraggedTypes;
<a name="l00297"></a>00297 
<a name="l00298"></a>00298     <a class="code" href="class_c_p_button.html">CPButton</a>                            _defaultButton;
<a name="l00299"></a>00299     BOOL                                _defaultButtonEnabled;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301     BOOL                                _autorecalculatesKeyViewLoop;
<a name="l00302"></a>00302     BOOL                                _keyViewLoopIsDirty;
<a name="l00303"></a>00303 
<a name="l00304"></a>00304     BOOL                                _sharesChromeWithPlatformWindow;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306     <span class="comment">// Bridge Support</span>
<a name="l00307"></a>00307 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00308"></a>00308 <span class="preprocessor"></span>    DOMElement                          _DOMElement;
<a name="l00309"></a>00309 <span class="preprocessor">#endif</span>
<a name="l00310"></a>00310 <span class="preprocessor"></span>
<a name="l00311"></a>00311     <span class="keywordtype">unsigned</span>                            _autoresizingMask;
<a name="l00312"></a>00312     
<a name="l00313"></a>00313     BOOL                                _delegateRespondsToWindowWillReturnUndoManagerSelector;
<a name="l00314"></a>00314 
<a name="l00315"></a>00315     BOOL                                _isFullPlatformWindow;
<a name="l00316"></a>00316     _CPWindowFullPlatformWindowSession  _fullPlatformWindowSession;
<a name="l00317"></a>00317     
<a name="l00318"></a>00318     <a class="code" href="class_c_p_dictionary.html" title="A mutable key-value pair collection.">CPDictionary</a>                        _sheetContext;
<a name="l00319"></a>00319     <a class="code" href="class_c_p_window.html">CPWindow</a>                            _parentView;
<a name="l00320"></a>00320     BOOL                                _isSheet;
<a name="l00321"></a>00321 }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 <span class="comment">/*</span>
<a name="l00324"></a>00324 <span class="comment">    Private initializer for Objective-J</span>
<a name="l00325"></a>00325 <span class="comment">    @ignore</span>
<a name="l00326"></a>00326 <span class="comment">*/</span>
<a name="l00327"></a><a class="code" href="class_c_p_window.html#a90717e1a2e3efc1443a50f9b3bb8cb1b">00327</a> + (void)initialize
<a name="l00328"></a>00328 {
<a name="l00329"></a>00329     <span class="keywordflow">if</span> (<span class="keyword">self</span> != [<a class="code" href="class_c_p_window.html">CPWindow</a> <span class="keyword">class</span>])
<a name="l00330"></a>00330         <span class="keywordflow">return</span>;
<a name="l00331"></a>00331     
<a name="l00332"></a>00332     var bundle = [<a class="code" href="class_c_p_bundle.html" title="Groups information about an application&amp;#39;s code &amp;amp; resources.">CPBundle</a> <a class="code" href="class_c_p_bundle.html#a6b2401dce4d84d49261126169d966567">bundleForClass</a>:[<a class="code" href="class_c_p_window.html">CPWindow</a> class]];
<a name="l00333"></a>00333     
<a name="l00334"></a>00334     <a class="code" href="_c_p_window_8j.html#a1cedf05cfa18440686df5fd4e2d62e74">CPWindowSavingImage</a> = [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPProgressIndicator/CPProgressIndicatorSpinningStyleRegular.gif&quot;] size:CGSizeMake(16.0, 16.0)]
<a name="l00335"></a>00335 }
<a name="l00336"></a>00336 
<a name="l00337"></a><a class="code" href="class_c_p_window.html#a8221f7e1a1299f0ec14d8817c749621e">00337</a> - (id)init
<a name="l00338"></a>00338 {
<a name="l00339"></a>00339     <span class="keywordflow">return</span> [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#aa8899214bfb73355f8f5ea13a6bc3ca5">initWithContentRect</a>:_CGRectMakeZero() <a class="code" href="class_c_p_window.html#aa8899214bfb73355f8f5ea13a6bc3ca5">styleMask</a>:CPTitledWindowMask];
<a name="l00340"></a>00340 }
<a name="l00341"></a>00341 
<a name="l00357"></a><a class="code" href="class_c_p_window.html#aa8899214bfb73355f8f5ea13a6bc3ca5">00357</a> - (id)initWithContentRect:(CGRect)aContentRect styleMask:(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)aStyleMask
<a name="l00358"></a>00358 {
<a name="l00359"></a>00359     <span class="keyword">self</span> = [<span class="keyword">super</span> init];
<a name="l00360"></a>00360     
<a name="l00361"></a>00361     <span class="keywordflow">if</span> (<span class="keyword">self</span>)
<a name="l00362"></a>00362     {
<a name="l00363"></a>00363         var windowViewClass = [[<span class="keyword">self</span> class] _windowViewClassForStyleMask:aStyleMask];
<a name="l00364"></a>00364 
<a name="l00365"></a>00365         _frame = [windowViewClass frameRectForContentRect:aContentRect];
<a name="l00366"></a>00366 
<a name="l00367"></a>00367         [<span class="keyword">self</span> _setSharesChromeWithPlatformWindow:![<a class="code" href="class_c_p_platform.html">CPPlatform</a> <a class="code" href="class_c_p_platform.html#add8d61d0f32ef6cac1102f1e1c70db78">isBrowser</a>]];
<a name="l00368"></a>00368 
<a name="l00369"></a>00369         <span class="keywordflow">if</span> ([<a class="code" href="class_c_p_platform.html">CPPlatform</a> isBrowser])
<a name="l00370"></a>00370             [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ac8089df19578e0ab96d138674e1236e4">setPlatformWindow</a>:[<a class="code" href="class_c_p_platform_window.html">CPPlatformWindow</a> <a class="code" href="class_c_p_platform_window.html#a5b0f6e7fb5ccfe5a7a4b4423ba65691a">primaryPlatformWindow</a>]];
<a name="l00371"></a>00371         <span class="keywordflow">else</span>
<a name="l00372"></a>00372         {
<a name="l00373"></a>00373             [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ac8089df19578e0ab96d138674e1236e4">setPlatformWindow</a>:[[<a class="code" href="class_c_p_platform_window.html">CPPlatformWindow</a> alloc] initWithContentRect:_frame]];
<a name="l00374"></a>00374             [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a0aefd4e1b2119ed015fcf990b3f167b5">platformWindow</a>]._only = <span class="keyword">self</span>;
<a name="l00375"></a>00375         }
<a name="l00376"></a>00376 
<a name="l00377"></a>00377         _isFullPlatformWindow = NO;
<a name="l00378"></a>00378         _registeredDraggedTypes = [<a class="code" href="class_c_p_set.html" title="An unordered collection of objects.">CPSet</a> <a class="code" href="class_c_p_set.html#a89623be28c3a0913db1967b667874d39">set</a>];
<a name="l00379"></a>00379         _registeredDraggedTypesArray = [];
<a name="l00380"></a>00380         _isSheet = NO;
<a name="l00381"></a>00381 
<a name="l00382"></a>00382         <span class="comment">// Set up our window number.</span>
<a name="l00383"></a>00383         _windowNumber = [CPApp._windows count];
<a name="l00384"></a>00384         <a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a>._windows[_windowNumber] = <span class="keyword">self</span>;
<a name="l00385"></a>00385         
<a name="l00386"></a>00386         _styleMask = aStyleMask;
<a name="l00387"></a>00387 
<a name="l00388"></a>00388         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab1e2a370eeb6dd942a3aed1e51fc12be">setLevel</a>:CPNormalWindowLevel];
<a name="l00389"></a>00389 
<a name="l00390"></a>00390         _minSize = <a class="code" href="_c_g_geometry_8j.html#ae46727e9923eb30b151ac3cbf6f0be42">CGSizeMake</a>(0.0, 0.0);
<a name="l00391"></a>00391         _maxSize = <a class="code" href="_c_g_geometry_8j.html#ae46727e9923eb30b151ac3cbf6f0be42">CGSizeMake</a>(1000000.0, 1000000.0);
<a name="l00392"></a>00392 
<a name="l00393"></a>00393         <span class="comment">// Create our border view which is the actual root of our view hierarchy.</span>
<a name="l00394"></a>00394         _windowView = [[windowViewClass alloc] initWithFrame:CGRectMake(0.0, 0.0, CGRectGetWidth(_frame), CGRectGetHeight(_frame)) styleMask:aStyleMask];
<a name="l00395"></a>00395 
<a name="l00396"></a>00396         [_windowView _setWindow:self];
<a name="l00397"></a>00397         [_windowView setNextResponder:self];
<a name="l00398"></a>00398 
<a name="l00399"></a>00399         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a4b299e3f1ade652283bce1f6c8e71b66">setMovableByWindowBackground</a>:aStyleMask &amp; CPHUDBackgroundWindowMask];
<a name="l00400"></a>00400         
<a name="l00401"></a>00401         <span class="comment">// Create a generic content view.</span>
<a name="l00402"></a>00402         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a534be05ab9332d4a8fe06dcaeeec50ed">setContentView</a>:[[<a class="code" href="class_c_p_view.html">CPView</a> alloc] initWithFrame:CGRectMakeZero()]];
<a name="l00403"></a>00403         
<a name="l00404"></a>00404         _firstResponder = <span class="keyword">self</span>;
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00407"></a>00407 <span class="preprocessor"></span>        _DOMElement = document.createElement(<span class="stringliteral">&quot;div&quot;</span>);
<a name="l00408"></a>00408         
<a name="l00409"></a>00409         _DOMElement.style.position = <span class="stringliteral">&quot;absolute&quot;</span>;
<a name="l00410"></a>00410         _DOMElement.style.visibility = <span class="stringliteral">&quot;visible&quot;</span>;
<a name="l00411"></a>00411         _DOMElement.style.zIndex = 0;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413         <span class="keywordflow">if</span> (![<span class="keyword">self</span> _sharesChromeWithPlatformWindow])
<a name="l00414"></a>00414         {
<a name="l00415"></a>00415             <a class="code" href="_c_p_d_o_m_display_server_8h.html#a75856b74f6280adbef51cd07108e12fa">CPDOMDisplayServerSetStyleLeftTop</a>(_DOMElement, NULL, _CGRectGetMinX(_frame), _CGRectGetMinY(_frame));
<a name="l00416"></a>00416         }
<a name="l00417"></a>00417 
<a name="l00418"></a>00418         <a class="code" href="_c_p_d_o_m_display_server_8h.html#adb3fd88967e3b3b1a999c5dbb5aa7068">CPDOMDisplayServerSetStyleSize</a>(_DOMElement, 1, 1);
<a name="l00419"></a>00419         <a class="code" href="_c_p_d_o_m_display_server_8h.html#a7674b6a309595bfd6886e83b5a7df3b2">CPDOMDisplayServerAppendChild</a>(_DOMElement, _windowView._DOMElement);
<a name="l00420"></a>00420 <span class="preprocessor">#endif</span>
<a name="l00421"></a>00421 <span class="preprocessor"></span>
<a name="l00422"></a>00422         [<span class="keyword">self</span> setNextResponder:CPApp];
<a name="l00423"></a>00423 
<a name="l00424"></a>00424         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab620f96fdedb91ae99a95eee0b3ff84b">setHasShadow</a>:aStyleMask !== CPBorderlessWindowMask];
<a name="l00425"></a>00425 
<a name="l00426"></a>00426         <span class="keywordflow">if</span> (aStyleMask &amp; <a class="code" href="_c_p_window_8j.html#ab9cb38d9cbdffe2bab2f10a4688545bd">CPBorderlessBridgeWindowMask</a>)
<a name="l00427"></a>00427             [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a2b9326a64bf79d8506022f8a9437fb5a">setFullPlatformWindow</a>:YES];
<a name="l00428"></a>00428 
<a name="l00429"></a>00429         _defaultButtonEnabled = YES;
<a name="l00430"></a>00430         _keyViewLoopIsDirty = YES;
<a name="l00431"></a>00431 
<a name="l00432"></a>00432         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ae3c64bcd7e145e6db87654e6a2d2f829">setShowsResizeIndicator</a>:_styleMask &amp; CPResizableWindowMask];
<a name="l00433"></a>00433     }
<a name="l00434"></a>00434     
<a name="l00435"></a>00435     <span class="keywordflow">return</span> <span class="keyword">self</span>;
<a name="l00436"></a>00436 }
<a name="l00437"></a>00437 
<a name="l00438"></a><a class="code" href="class_c_p_window.html#a0aefd4e1b2119ed015fcf990b3f167b5">00438</a> - (<a class="code" href="class_c_p_platform_window.html">CPPlatformWindow</a>)platformWindow
<a name="l00439"></a>00439 {
<a name="l00440"></a>00440     <span class="keywordflow">return</span> _platformWindow;
<a name="l00441"></a>00441 }
<a name="l00442"></a>00442 
<a name="l00443"></a><a class="code" href="class_c_p_window.html#ac8089df19578e0ab96d138674e1236e4">00443</a> - (void)setPlatformWindow:(<a class="code" href="class_c_p_platform_window.html">CPPlatformWindow</a>)aPlatformWindow
<a name="l00444"></a>00444 {
<a name="l00445"></a>00445     <span class="comment">// FIXME: already visible.</span>
<a name="l00446"></a>00446     _platformWindow = aPlatformWindow;
<a name="l00447"></a>00447 }
<a name="l00448"></a>00448 
<a name="l00452"></a>00452 + (Class)_windowViewClassForStyleMask:(<span class="keywordtype">unsigned</span>)aStyleMask
<a name="l00453"></a>00453 {
<a name="l00454"></a>00454     <span class="keywordflow">if</span> (aStyleMask &amp; <a class="code" href="_c_p_window_8j.html#a550358819a66f387034d69aef39cc480">CPHUDBackgroundWindowMask</a>)
<a name="l00455"></a>00455         <span class="keywordflow">return</span> _CPHUDWindowView;
<a name="l00456"></a>00456 
<a name="l00457"></a>00457     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (aStyleMask === <a class="code" href="_c_p_window_8j.html#a98f5b5b410df12afdd80828a544f029b">CPBorderlessWindowMask</a>)
<a name="l00458"></a>00458         <span class="keywordflow">return</span> _CPBorderlessWindowView;
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (aStyleMask &amp; <a class="code" href="_c_p_panel_8j.html#aafbda0ed0f079bf2bc0b1defade754e8">CPDocModalWindowMask</a>)
<a name="l00461"></a>00461         <span class="keywordflow">return</span> _CPDocModalWindowView;
<a name="l00462"></a>00462 
<a name="l00463"></a>00463     <span class="keywordflow">return</span> _CPStandardWindowView;
<a name="l00464"></a>00464 }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466 + (Class)_windowViewClassForFullPlatformWindowStyleMask:(<span class="keywordtype">unsigned</span>)aStyleMask
<a name="l00467"></a>00467 {
<a name="l00468"></a>00468     <span class="keywordflow">return</span> _CPBorderlessBridgeWindowView;
<a name="l00469"></a>00469 }
<a name="l00470"></a>00470 
<a name="l00471"></a><a class="code" href="class_c_p_window.html#acac0ce6d44cdd970a318b561d70f0596">00471</a> - (void)awakeFromCib
<a name="l00472"></a>00472 {
<a name="l00473"></a>00473     <span class="keywordflow">if</span> (_initialFirstResponder)
<a name="l00474"></a>00474         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#abaf02cdc9845e6ceb278b6fe6c4e0074">makeFirstResponder</a>:_initialFirstResponder];
<a name="l00475"></a>00475 
<a name="l00476"></a>00476     _keyViewLoopIsDirty = ![<span class="keyword">self</span> _hasKeyViewLoop];
<a name="l00477"></a>00477 }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479 - (void)_setWindowView:(<a class="code" href="class_c_p_view.html">CPView</a>)aWindowView
<a name="l00480"></a>00480 {
<a name="l00481"></a>00481     <span class="keywordflow">if</span> (_windowView === aWindowView)
<a name="l00482"></a>00482         <span class="keywordflow">return</span>;
<a name="l00483"></a>00483 
<a name="l00484"></a>00484     var oldWindowView = _windowView;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486     _windowView = aWindowView;
<a name="l00487"></a>00487 
<a name="l00488"></a>00488     <span class="keywordflow">if</span> (oldWindowView)
<a name="l00489"></a>00489     {
<a name="l00490"></a>00490         [oldWindowView _setWindow:nil];
<a name="l00491"></a>00491         [oldWindowView noteToolbarChanged];
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00494"></a>00494 <span class="preprocessor"></span>        <a class="code" href="_c_p_d_o_m_display_server_8h.html#a516e8fe3a142194da3a9aa3cc9da1130">CPDOMDisplayServerRemoveChild</a>(_DOMElement, oldWindowView._DOMElement);
<a name="l00495"></a>00495 <span class="preprocessor">#endif</span>
<a name="l00496"></a>00496 <span class="preprocessor"></span>    }
<a name="l00497"></a>00497 
<a name="l00498"></a>00498     <span class="keywordflow">if</span> (_windowView)
<a name="l00499"></a>00499     {
<a name="l00500"></a>00500 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00501"></a>00501 <span class="preprocessor"></span>        <a class="code" href="_c_p_d_o_m_display_server_8h.html#a7674b6a309595bfd6886e83b5a7df3b2">CPDOMDisplayServerAppendChild</a>(_DOMElement, _windowView._DOMElement);
<a name="l00502"></a>00502 <span class="preprocessor">#endif</span>
<a name="l00503"></a>00503 <span class="preprocessor"></span>
<a name="l00504"></a>00504         var contentRect = [_contentView convertRect:[_contentView bounds] toView:nil];
<a name="l00505"></a>00505 
<a name="l00506"></a>00506         contentRect.origin = [<span class="keyword">self</span> convertBaseToGlobal:contentRect.origin];
<a name="l00507"></a>00507 
<a name="l00508"></a>00508         [_windowView _setWindow:self];
<a name="l00509"></a>00509         [_windowView setNextResponder:self];
<a name="l00510"></a>00510         [_windowView addSubview:_contentView];
<a name="l00511"></a>00511         [_windowView setTitle:_title];
<a name="l00512"></a>00512         [_windowView noteToolbarChanged];
<a name="l00513"></a>00513         [_windowView setShowsResizeIndicator:[<span class="keyword">self</span> showsResizeIndicator]];
<a name="l00514"></a>00514 
<a name="l00515"></a>00515         [<span class="keyword">self</span> setFrame:[<span class="keyword">self</span> frameRectForContentRect:contentRect]];
<a name="l00516"></a>00516     }
<a name="l00517"></a>00517 }
<a name="l00518"></a>00518 
<a name="l00519"></a><a class="code" href="class_c_p_window.html#a2b9326a64bf79d8506022f8a9437fb5a">00519</a> - (void)setFullPlatformWindow:(BOOL)shouldBeFullPlatformWindow
<a name="l00520"></a>00520 {
<a name="l00521"></a>00521     <span class="keywordflow">if</span> (![_platformWindow supportsFullPlatformWindows])
<a name="l00522"></a>00522         <span class="keywordflow">return</span>;
<a name="l00523"></a>00523 
<a name="l00524"></a>00524     shouldBeFullPlatformWindow = !!shouldBeFullPlatformWindow;
<a name="l00525"></a>00525 
<a name="l00526"></a>00526     <span class="keywordflow">if</span> (_isFullPlatformWindow === shouldBeFullPlatformWindow)
<a name="l00527"></a>00527         <span class="keywordflow">return</span>;
<a name="l00528"></a>00528 
<a name="l00529"></a>00529     _isFullPlatformWindow = shouldBeFullPlatformWindow;
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     <span class="keywordflow">if</span> (_isFullPlatformWindow)
<a name="l00532"></a>00532     {
<a name="l00533"></a>00533         _fullPlatformWindowSession = _CPWindowFullPlatformWindowSessionMake(_windowView, [<span class="keyword">self</span> contentRectForFrameRect:[<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]], [<span class="keyword">self</span> hasShadow], [<span class="keyword">self</span> level]);
<a name="l00534"></a>00534 
<a name="l00535"></a>00535         var fullPlatformWindowViewClass = [[<span class="keyword">self</span> class] _windowViewClassForFullPlatformWindowStyleMask:_styleMask],
<a name="l00536"></a>00536             windowView = [[fullPlatformWindowViewClass alloc] initWithFrame:CGRectMakeZero() styleMask:_styleMask];
<a name="l00537"></a>00537 
<a name="l00538"></a>00538         [<span class="keyword">self</span> _setWindowView:windowView];
<a name="l00539"></a>00539 
<a name="l00540"></a>00540         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab1e2a370eeb6dd942a3aed1e51fc12be">setLevel</a>:CPBackgroundWindowLevel];
<a name="l00541"></a>00541         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab620f96fdedb91ae99a95eee0b3ff84b">setHasShadow</a>:NO];
<a name="l00542"></a>00542         [<span class="keyword">self</span> setAutoresizingMask:CPWindowWidthSizable | CPWindowHeightSizable];
<a name="l00543"></a>00543         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a7e55ac7c5a17669d408e497b4ae7d651">setFrame</a>:[_platformWindow visibleFrame]];
<a name="l00544"></a>00544     }
<a name="l00545"></a>00545     <span class="keywordflow">else</span>
<a name="l00546"></a>00546     {
<a name="l00547"></a>00547         var windowView = _fullPlatformWindowSession.windowView;
<a name="l00548"></a>00548 
<a name="l00549"></a>00549         [<span class="keyword">self</span> _setWindowView:windowView];
<a name="l00550"></a>00550 
<a name="l00551"></a>00551         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab1e2a370eeb6dd942a3aed1e51fc12be">setLevel</a>:_fullPlatformWindowSession.level];
<a name="l00552"></a>00552         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab620f96fdedb91ae99a95eee0b3ff84b">setHasShadow</a>:_fullPlatformWindowSession.hasShadow];
<a name="l00553"></a>00553         [<span class="keyword">self</span> setAutoresizingMask:CPWindowNotSizable];
<a name="l00554"></a>00554 
<a name="l00555"></a>00555         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a7e55ac7c5a17669d408e497b4ae7d651">setFrame</a>:[windowView frameRectForContentRect:_fullPlatformWindowSession.contentRect]];
<a name="l00556"></a>00556     }
<a name="l00557"></a>00557 }
<a name="l00558"></a>00558 
<a name="l00559"></a><a class="code" href="class_c_p_window.html#af9c54355c1fb988869cab246aeb4376b">00559</a> - (BOOL)isFullPlatformWindow
<a name="l00560"></a>00560 {
<a name="l00561"></a>00561     <span class="keywordflow">return</span> _isFullPlatformWindow;
<a name="l00562"></a>00562 }
<a name="l00563"></a>00563 
<a name="l00567"></a><a class="code" href="class_c_p_window.html#a8b303767f2922c1c0857b239d0714137">00567</a> - (unsigned)styleMask
<a name="l00568"></a>00568 {
<a name="l00569"></a>00569     <span class="keywordflow">return</span> _styleMask;
<a name="l00570"></a>00570 }
<a name="l00571"></a>00571 
<a name="l00578"></a><a class="code" href="class_c_p_window.html#a864679548e9f9ce65ffae4b70516afd5">00578</a> + (CGRect)frameRectForContentRect:(CGRect)aContentRect styleMask:(<span class="keywordtype">unsigned</span>)aStyleMask
<a name="l00579"></a>00579 {
<a name="l00580"></a>00580     <span class="keywordflow">return</span> [[[<span class="keyword">self</span> class] _windowViewClassForStyleMask:aStyleMask] frameRectForContentRect:aContentRect];
<a name="l00581"></a>00581 }
<a name="l00582"></a>00582 
<a name="l00587"></a><a class="code" href="class_c_p_window.html#ad0a4e8350730362dad9543e9ca762da5">00587</a> - (CGRect)contentRectForFrameRect:(CGRect)aFrame
<a name="l00588"></a>00588 {
<a name="l00589"></a>00589     <span class="keywordflow">return</span> [_windowView contentRectForFrameRect:aFrame];
<a name="l00590"></a>00590 }
<a name="l00591"></a>00591 
<a name="l00597"></a><a class="code" href="class_c_p_window.html#a6af6ec52f565970dbd8721414e478fa1">00597</a> - (CGRect)frameRectForContentRect:(CGRect)aContentRect
<a name="l00598"></a>00598 {
<a name="l00599"></a>00599     <span class="keywordflow">return</span> [_windowView frameRectForContentRect:aContentRect];
<a name="l00600"></a>00600 }
<a name="l00601"></a>00601 
<a name="l00605"></a><a class="code" href="class_c_p_window.html#a0eddef926f318eecaf793e702be6d5a5">00605</a> - (CGRect)<a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>
<a name="l00606"></a>00606 {
<a name="l00607"></a>00607     <span class="keywordflow">return</span> _CGRectMakeCopy(_frame);
<a name="l00608"></a>00608 }
<a name="l00609"></a>00609 
<a name="l00617"></a><a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">00617</a> - (void)setFrame:(CGRect)aFrame display:(BOOL)shouldDisplay animate:(BOOL)shouldAnimate
<a name="l00618"></a>00618 {
<a name="l00619"></a>00619     aFrame = _CGRectMakeCopy(aFrame);
<a name="l00620"></a>00620 
<a name="l00621"></a>00621     var value = aFrame.origin.x,
<a name="l00622"></a>00622         delta = value - FLOOR(value);
<a name="l00623"></a>00623 
<a name="l00624"></a>00624     <span class="keywordflow">if</span> (delta)
<a name="l00625"></a>00625         aFrame.origin.x = value &gt; 0.879 ? CEIL(value) : FLOOR(value);
<a name="l00626"></a>00626 
<a name="l00627"></a>00627     value = aFrame.origin.y;
<a name="l00628"></a>00628     delta = value - FLOOR(value);
<a name="l00629"></a>00629 
<a name="l00630"></a>00630     <span class="keywordflow">if</span> (delta)
<a name="l00631"></a>00631         aFrame.origin.y = value &gt; 0.879 ? CEIL(value) : FLOOR(value);
<a name="l00632"></a>00632 
<a name="l00633"></a>00633     value = aFrame.size.width;
<a name="l00634"></a>00634     delta = value - FLOOR(value);
<a name="l00635"></a>00635 
<a name="l00636"></a>00636     <span class="keywordflow">if</span> (delta)
<a name="l00637"></a>00637         aFrame.size.width = value &gt; 0.15 ? CEIL(value) : FLOOR(value);
<a name="l00638"></a>00638 
<a name="l00639"></a>00639     value = aFrame.size.height;
<a name="l00640"></a>00640     delta = value - FLOOR(value);
<a name="l00641"></a>00641 
<a name="l00642"></a>00642     <span class="keywordflow">if</span> (delta)
<a name="l00643"></a>00643         aFrame.size.height = value &gt; 0.15 ? CEIL(value) : FLOOR(value);
<a name="l00644"></a>00644 
<a name="l00645"></a>00645     <span class="keywordflow">if</span> (shouldAnimate)
<a name="l00646"></a>00646     {
<a name="l00647"></a>00647         var animation = [[_CPWindowFrameAnimation alloc] initWithWindow:self targetFrame:aFrame];
<a name="l00648"></a>00648     
<a name="l00649"></a>00649         [animation startAnimation];
<a name="l00650"></a>00650     }
<a name="l00651"></a>00651     <span class="keywordflow">else</span>
<a name="l00652"></a>00652     {
<a name="l00653"></a>00653         var origin = _frame.origin,
<a name="l00654"></a>00654             newOrigin = aFrame.origin;
<a name="l00655"></a>00655 
<a name="l00656"></a>00656         <span class="keywordflow">if</span> (!_CGPointEqualToPoint(origin, newOrigin))
<a name="l00657"></a>00657         {
<a name="l00658"></a>00658             origin.x = newOrigin.x;
<a name="l00659"></a>00659             origin.y = newOrigin.y;
<a name="l00660"></a>00660 
<a name="l00661"></a>00661 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00662"></a>00662 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (![<span class="keyword">self</span> _sharesChromeWithPlatformWindow])
<a name="l00663"></a>00663             {
<a name="l00664"></a>00664                 <a class="code" href="_c_p_d_o_m_display_server_8h.html#a75856b74f6280adbef51cd07108e12fa">CPDOMDisplayServerSetStyleLeftTop</a>(_DOMElement, NULL, origin.x, origin.y);
<a name="l00665"></a>00665             }
<a name="l00666"></a>00666 <span class="preprocessor">#endif</span>
<a name="l00667"></a>00667 <span class="preprocessor"></span>
<a name="l00668"></a>00668             [[<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowDidMoveNotification <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l00669"></a>00669         }
<a name="l00670"></a>00670 
<a name="l00671"></a>00671         var <a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a> = _frame.size,
<a name="l00672"></a>00672             newSize = aFrame.size;
<a name="l00673"></a>00673 
<a name="l00674"></a>00674         <span class="keywordflow">if</span> (!_CGSizeEqualToSize(size, newSize))
<a name="l00675"></a>00675         {
<a name="l00676"></a>00676             size.width = <a class="code" href="_c_p_obj_j_runtime_8j.html#a4fca277171215842609dc38a6f0c19fb">MIN</a>(<a class="code" href="_c_p_obj_j_runtime_8j.html#a45f5f88d061da0c18bcb6b6a854fe898">MAX</a>(newSize.width, _minSize.width), _maxSize.width);
<a name="l00677"></a>00677             size.height = <a class="code" href="_c_p_obj_j_runtime_8j.html#a4fca277171215842609dc38a6f0c19fb">MIN</a>(<a class="code" href="_c_p_obj_j_runtime_8j.html#a45f5f88d061da0c18bcb6b6a854fe898">MAX</a>(newSize.height, _minSize.height), _maxSize.height);
<a name="l00678"></a>00678 
<a name="l00679"></a>00679             [_windowView setFrameSize:size];
<a name="l00680"></a>00680 
<a name="l00681"></a>00681             <span class="keywordflow">if</span> (_hasShadow)
<a name="l00682"></a>00682                 [_shadowView setFrameSize:_CGSizeMake(SHADOW_MARGIN_LEFT + size.width + SHADOW_MARGIN_RIGHT, SHADOW_MARGIN_BOTTOM + size.height + SHADOW_MARGIN_TOP + SHADOW_DISTANCE)];
<a name="l00683"></a>00683 
<a name="l00684"></a>00684             <span class="keywordflow">if</span> (!_isAnimating)
<a name="l00685"></a>00685                 [[<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowDidResizeNotification <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l00686"></a>00686         }
<a name="l00687"></a>00687 
<a name="l00688"></a>00688         <span class="keywordflow">if</span> ([<span class="keyword">self</span> _sharesChromeWithPlatformWindow])
<a name="l00689"></a>00689             [_platformWindow setContentRect:_frame];
<a name="l00690"></a>00690     }
<a name="l00691"></a>00691 }
<a name="l00692"></a>00692 
<a name="l00693"></a><a class="code" href="class_c_p_window.html#afd88939930b0f35a24f2887cd662deee">00693</a> - (void)setFrame:(CGRect)aFrame display:(BOOL)shouldDisplay
<a name="l00694"></a>00694 {
<a name="l00695"></a>00695     [<span class="keyword">super</span> setFrame:aFrame display:shouldDisplay animate:NO];
<a name="l00696"></a>00696 }
<a name="l00697"></a>00697 
<a name="l00701"></a><a class="code" href="class_c_p_window.html#a7e55ac7c5a17669d408e497b4ae7d651">00701</a> - (void)setFrame:(CGRect)aFrame
<a name="l00702"></a>00702 {
<a name="l00703"></a>00703     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">setFrame</a>:aFrame <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">display</a>:YES <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">animate</a>:NO];
<a name="l00704"></a>00704 }
<a name="l00705"></a>00705 
<a name="l00710"></a><a class="code" href="class_c_p_window.html#af2c6d92c09cf5c4e3cb79e95a8487a4a">00710</a> - (void)setFrameOrigin:(CGPoint)anOrigin
<a name="l00711"></a>00711 {
<a name="l00712"></a>00712     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">setFrame</a>:_CGRectMake(anOrigin.x, anOrigin.y, _CGRectGetWidth(_frame), _CGRectGetHeight(_frame)) <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">display</a>:YES <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">animate</a>:NO];
<a name="l00713"></a>00713 }
<a name="l00714"></a>00714 
<a name="l00719"></a><a class="code" href="class_c_p_window.html#a78f54abf39bc3d0b26714ba417a284fa">00719</a> - (void)setFrameSize:(CGSize)aSize
<a name="l00720"></a>00720 {
<a name="l00721"></a>00721     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">setFrame</a>:_CGRectMake(_CGRectGetMinX(_frame), _CGRectGetMinY(_frame), aSize.width, aSize.height) <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">display</a>:YES <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">animate</a>:NO];
<a name="l00722"></a>00722 }
<a name="l00723"></a>00723 
<a name="l00728"></a><a class="code" href="class_c_p_window.html#a4c3bebfd3f9b356fe3528f8697e95b0a">00728</a> - (void)orderFront:(<span class="keywordtype">id</span>)aSender
<a name="l00729"></a>00729 {
<a name="l00730"></a>00730     [_platformWindow orderFront:self];
<a name="l00731"></a>00731     [_platformWindow order:CPWindowAbove window:self relativeTo:nil];
<a name="l00732"></a>00732 }
<a name="l00733"></a>00733 
<a name="l00734"></a>00734 <span class="comment">/*</span>
<a name="l00735"></a>00735 <span class="comment">    Makes the receiver the last window in the screen ordering.</span>
<a name="l00736"></a>00736 <span class="comment">    @param aSender the object that requested this</span>
<a name="l00737"></a>00737 <span class="comment">    @ignore</span>
<a name="l00738"></a>00738 <span class="comment">*/</span>
<a name="l00739"></a><a class="code" href="class_c_p_window.html#abc13040362286cae8d5d1f3974c51626">00739</a> - (void)orderBack:(<span class="keywordtype">id</span>)aSender
<a name="l00740"></a>00740 {
<a name="l00741"></a>00741     <span class="comment">//[_platformWindow order:CPWindowBelow</span>
<a name="l00742"></a>00742 }
<a name="l00743"></a>00743 
<a name="l00748"></a><a class="code" href="class_c_p_window.html#a7499cfb057ea3359b4d3bc3652efefaf">00748</a> - (void)orderOut:(<span class="keywordtype">id</span>)aSender
<a name="l00749"></a>00749 {
<a name="l00750"></a>00750     <span class="keywordflow">if</span> ([<span class="keyword">self</span> _sharesChromeWithPlatformWindow])
<a name="l00751"></a>00751         [_platformWindow orderOut:self];
<a name="l00752"></a>00752 
<a name="l00753"></a>00753     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowWillClose:)])
<a name="l00754"></a>00754         [_delegate windowWillClose:self];
<a name="l00755"></a>00755 
<a name="l00756"></a>00756     [_platformWindow order:CPWindowOut window:self relativeTo:nil];
<a name="l00757"></a>00757 
<a name="l00758"></a>00758     <span class="keywordflow">if</span> ([<a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a> keyWindow] == <span class="keyword">self</span>)
<a name="l00759"></a>00759     {
<a name="l00760"></a>00760         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a7eccad1de6cc0ca8c23dae1d4eeca57c">resignKeyWindow</a>];
<a name="l00761"></a>00761 
<a name="l00762"></a>00762         <a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a>._keyWindow = nil;
<a name="l00763"></a>00763     }
<a name="l00764"></a>00764 }
<a name="l00765"></a>00765 
<a name="l00771"></a><a class="code" href="class_c_p_window.html#aa7d4a5bd56c90ba672b40bfcef38843b">00771</a> - (void)orderWindow:(CPWindowOrderingMode)aPlace relativeTo:(<span class="keywordtype">int</span>)otherWindowNumber
<a name="l00772"></a>00772 {
<a name="l00773"></a>00773     [_platformWindow order:aPlace window:self relativeTo:CPApp._windows[otherWindowNumber]];
<a name="l00774"></a>00774 }
<a name="l00775"></a>00775 
<a name="l00780"></a><a class="code" href="class_c_p_window.html#ab1e2a370eeb6dd942a3aed1e51fc12be">00780</a> - (void)setLevel:(<span class="keywordtype">int</span>)aLevel
<a name="l00781"></a>00781 {
<a name="l00782"></a>00782     _level = aLevel;
<a name="l00783"></a>00783 
<a name="l00784"></a>00784     <span class="keywordflow">if</span> ([<span class="keyword">self</span> _sharesChromeWithPlatformWindow])
<a name="l00785"></a>00785         [_platformWindow setLevel:aLevel];
<a name="l00786"></a>00786 }
<a name="l00787"></a>00787 
<a name="l00791"></a><a class="code" href="class_c_p_window.html#a382c894d3d0ac1e20aba1b98c7bbddf2">00791</a> - (int)level
<a name="l00792"></a>00792 {
<a name="l00793"></a>00793     <span class="keywordflow">return</span> _level;
<a name="l00794"></a>00794 }
<a name="l00795"></a>00795 
<a name="l00799"></a><a class="code" href="class_c_p_window.html#ae49f85afe20484449e51489a84342abe">00799</a> - (BOOL)isVisible
<a name="l00800"></a>00800 {
<a name="l00801"></a>00801     <span class="keywordflow">return</span> _isVisible;
<a name="l00802"></a>00802 }
<a name="l00803"></a>00803 
<a name="l00807"></a><a class="code" href="class_c_p_window.html#a99f527b7d848e74e51d31b50e1a58468">00807</a> - (BOOL)showsResizeIndicator
<a name="l00808"></a>00808 {
<a name="l00809"></a>00809     <span class="keywordflow">return</span> _showsResizeIndicator;
<a name="l00810"></a>00810 }
<a name="l00811"></a>00811 
<a name="l00816"></a><a class="code" href="class_c_p_window.html#ae3c64bcd7e145e6db87654e6a2d2f829">00816</a> - (void)setShowsResizeIndicator:(BOOL)shouldShowResizeIndicator
<a name="l00817"></a>00817 {
<a name="l00818"></a>00818     shouldShowResizeIndicator = !!shouldShowResizeIndicator;
<a name="l00819"></a>00819 
<a name="l00820"></a>00820     <span class="keywordflow">if</span> (_showsResizeIndicator === shouldShowResizeIndicator)
<a name="l00821"></a>00821         <span class="keywordflow">return</span>;
<a name="l00822"></a>00822 
<a name="l00823"></a>00823     _showsResizeIndicator = shouldShowResizeIndicator;
<a name="l00824"></a>00824     [_windowView setShowsResizeIndicator:[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a99f527b7d848e74e51d31b50e1a58468">showsResizeIndicator</a>]];
<a name="l00825"></a>00825 }
<a name="l00826"></a>00826 
<a name="l00830"></a><a class="code" href="class_c_p_window.html#aa4716b33e16ac233fecd23b0c98cd133">00830</a> - (CGSize)resizeIndicatorOffset
<a name="l00831"></a>00831 {
<a name="l00832"></a>00832     <span class="keywordflow">return</span> [_windowView resizeIndicatorOffset];
<a name="l00833"></a>00833 }
<a name="l00834"></a>00834 
<a name="l00839"></a><a class="code" href="class_c_p_window.html#abdb142f571a0012cbf75f9c53ed71950">00839</a> - (void)setResizeIndicatorOffset:(CGSize)anOffset
<a name="l00840"></a>00840 {
<a name="l00841"></a>00841     [_windowView setResizeIndicatorOffset:anOffset];
<a name="l00842"></a>00842 }
<a name="l00843"></a>00843 
<a name="l00849"></a><a class="code" href="class_c_p_window.html#a534be05ab9332d4a8fe06dcaeeec50ed">00849</a> - (void)setContentView:(<a class="code" href="class_c_p_view.html">CPView</a>)aView
<a name="l00850"></a>00850 {
<a name="l00851"></a>00851     <span class="keywordflow">if</span> (_contentView)
<a name="l00852"></a>00852         [_contentView removeFromSuperview];
<a name="l00853"></a>00853     
<a name="l00854"></a>00854     var bounds = <a class="code" href="_c_g_geometry_8j.html#aca150c0049e24797c6271bad7bc90610">CGRectMake</a>(0.0, 0.0, <a class="code" href="_c_g_geometry_8j.html#aa310af239f2108c573299b35776996fa">CGRectGetWidth</a>(_frame), <a class="code" href="_c_g_geometry_8j.html#a09d2072d60c7f39b04a41705d640fa98">CGRectGetHeight</a>(_frame));
<a name="l00855"></a>00855     
<a name="l00856"></a>00856     _contentView = aView;
<a name="l00857"></a>00857     [_contentView setFrame:[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ad0a4e8350730362dad9543e9ca762da5">contentRectForFrameRect</a>:bounds]];
<a name="l00858"></a>00858     
<a name="l00859"></a>00859     [_contentView setAutoresizingMask:CPViewWidthSizable | CPViewHeightSizable];
<a name="l00860"></a>00860     [_windowView addSubview:_contentView];
<a name="l00861"></a>00861 }
<a name="l00862"></a>00862 
<a name="l00866"></a><a class="code" href="class_c_p_window.html#ae8ea24657fb8bfaf38cba633ce8d4a21">00866</a> - (<a class="code" href="class_c_p_view.html">CPView</a>)contentView
<a name="l00867"></a>00867 {
<a name="l00868"></a>00868     <span class="keywordflow">return</span> _contentView;
<a name="l00869"></a>00869 }
<a name="l00870"></a>00870 
<a name="l00875"></a><a class="code" href="class_c_p_window.html#afa753c01eed9d857117b4d77dd1bfaba">00875</a> - (void)setBackgroundColor:(CPColor)aColor
<a name="l00876"></a>00876 {
<a name="l00877"></a>00877     [_windowView setBackgroundColor:aColor];
<a name="l00878"></a>00878 }
<a name="l00879"></a>00879 
<a name="l00883"></a><a class="code" href="class_c_p_window.html#a1dbcb5e82208efb74e44c9bf1e48682f">00883</a> - (CPColor)backgroundColor
<a name="l00884"></a>00884 {
<a name="l00885"></a>00885     <span class="keywordflow">return</span> [_windowView backgroundColor];
<a name="l00886"></a>00886 }
<a name="l00887"></a>00887 
<a name="l00893"></a><a class="code" href="class_c_p_window.html#a80b34a6cb65d947d4afe3ddaf5f51a8f">00893</a> - (void)setMinSize:(CGSize)aSize
<a name="l00894"></a>00894 {
<a name="l00895"></a>00895     <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a1eefbb30f35d5c4f4473bec9a2ebff9f">CGSizeEqualToSize</a>(_minSize, aSize))
<a name="l00896"></a>00896         <span class="keywordflow">return</span>;
<a name="l00897"></a>00897     
<a name="l00898"></a>00898     _minSize = <a class="code" href="_c_g_geometry_8j.html#ac0ce05074e36a3ea5cdc40d111b6d8b5">CGSizeCreateCopy</a>(aSize);
<a name="l00899"></a>00899 
<a name="l00900"></a>00900     var <a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a> = <a class="code" href="_c_g_geometry_8j.html#affb0172e44ea288a2660c9a5394db33a">CGSizeMakeCopy</a>([<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>].<a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>),
<a name="l00901"></a>00901         needsFrameChange = NO;
<a name="l00902"></a>00902     
<a name="l00903"></a>00903     <span class="keywordflow">if</span> (<a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.width &lt; _minSize.width)
<a name="l00904"></a>00904     {
<a name="l00905"></a>00905         <a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.width = _minSize.width;
<a name="l00906"></a>00906         needsFrameChange = YES;
<a name="l00907"></a>00907     }
<a name="l00908"></a>00908     
<a name="l00909"></a>00909     <span class="keywordflow">if</span> (<a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.height &lt; _minSize.height)
<a name="l00910"></a>00910     {
<a name="l00911"></a>00911         <a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.height = _minSize.height;
<a name="l00912"></a>00912         needsFrameChange = YES;
<a name="l00913"></a>00913     }
<a name="l00914"></a>00914     
<a name="l00915"></a>00915     <span class="keywordflow">if</span> (needsFrameChange)
<a name="l00916"></a>00916         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a78f54abf39bc3d0b26714ba417a284fa">setFrameSize</a>:size];
<a name="l00917"></a>00917 }
<a name="l00918"></a>00918 
<a name="l00922"></a><a class="code" href="class_c_p_window.html#ab227183c80e4c44053439b1f7a61590e">00922</a> - (CGSize)minSize
<a name="l00923"></a>00923 {
<a name="l00924"></a>00924     <span class="keywordflow">return</span> _minSize;
<a name="l00925"></a>00925 }
<a name="l00926"></a>00926 
<a name="l00933"></a><a class="code" href="class_c_p_window.html#aa02cdc9f817ec2cad1750c48c96e86b1">00933</a> - (void)setMaxSize:(CGSize)aSize
<a name="l00934"></a>00934 {
<a name="l00935"></a>00935     <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a1eefbb30f35d5c4f4473bec9a2ebff9f">CGSizeEqualToSize</a>(_maxSize, aSize))
<a name="l00936"></a>00936         <span class="keywordflow">return</span>;
<a name="l00937"></a>00937     
<a name="l00938"></a>00938     _maxSize = <a class="code" href="_c_g_geometry_8j.html#ac0ce05074e36a3ea5cdc40d111b6d8b5">CGSizeCreateCopy</a>(aSize);
<a name="l00939"></a>00939 
<a name="l00940"></a>00940     var <a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a> = <a class="code" href="_c_g_geometry_8j.html#affb0172e44ea288a2660c9a5394db33a">CGSizeMakeCopy</a>([<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>].<a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>),
<a name="l00941"></a>00941         needsFrameChange = NO;
<a name="l00942"></a>00942     
<a name="l00943"></a>00943     <span class="keywordflow">if</span> (<a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.width &gt; _maxSize.width)
<a name="l00944"></a>00944     {
<a name="l00945"></a>00945         <a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.width = _maxSize.width;
<a name="l00946"></a>00946         needsFrameChange = YES;
<a name="l00947"></a>00947     }
<a name="l00948"></a>00948     
<a name="l00949"></a>00949     <span class="keywordflow">if</span> (<a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.height &gt; _maxSize.height)
<a name="l00950"></a>00950     {
<a name="l00951"></a>00951         <a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.height = _maxSize.height;
<a name="l00952"></a>00952         needsFrameChange = YES;
<a name="l00953"></a>00953     }
<a name="l00954"></a>00954     
<a name="l00955"></a>00955     <span class="keywordflow">if</span> (needsFrameChange)
<a name="l00956"></a>00956         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a78f54abf39bc3d0b26714ba417a284fa">setFrameSize</a>:size];
<a name="l00957"></a>00957 }
<a name="l00958"></a>00958 
<a name="l00962"></a><a class="code" href="class_c_p_window.html#aa7168a15f2e0b7f0ee8d8702010090ae">00962</a> - (CGSize)maxSize
<a name="l00963"></a>00963 {
<a name="l00964"></a>00964     <span class="keywordflow">return</span> _maxSize;
<a name="l00965"></a>00965 }
<a name="l00966"></a>00966 
<a name="l00970"></a><a class="code" href="class_c_p_window.html#a353baefd1f7683c6b2b9cf0083f2ad45">00970</a> - (BOOL)hasShadow
<a name="l00971"></a>00971 {
<a name="l00972"></a>00972     <span class="keywordflow">return</span> _hasShadow;
<a name="l00973"></a>00973 }
<a name="l00974"></a>00974 
<a name="l00975"></a>00975 - (void)_updateShadow
<a name="l00976"></a>00976 {
<a name="l00977"></a>00977     <span class="keywordflow">if</span> ([<span class="keyword">self</span> _sharesChromeWithPlatformWindow])
<a name="l00978"></a>00978     {
<a name="l00979"></a>00979         <span class="keywordflow">if</span> (_shadowView)
<a name="l00980"></a>00980         {
<a name="l00981"></a>00981 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00982"></a>00982 <span class="preprocessor"></span>            <a class="code" href="_c_p_d_o_m_display_server_8h.html#a516e8fe3a142194da3a9aa3cc9da1130">CPDOMDisplayServerRemoveChild</a>(_DOMElement, _shadowView._DOMElement);
<a name="l00983"></a>00983 <span class="preprocessor">#endif</span>
<a name="l00984"></a>00984 <span class="preprocessor"></span>            _shadowView = nil;
<a name="l00985"></a>00985         }
<a name="l00986"></a>00986 
<a name="l00987"></a>00987         [_platformWindow setHasShadow:_hasShadow];
<a name="l00988"></a>00988 
<a name="l00989"></a>00989         <span class="keywordflow">return</span>;
<a name="l00990"></a>00990     }
<a name="l00991"></a>00991 
<a name="l00992"></a>00992     <span class="keywordflow">if</span> (_hasShadow &amp;&amp; !_shadowView)
<a name="l00993"></a>00993     {
<a name="l00994"></a>00994         var bounds = [_windowView bounds];
<a name="l00995"></a>00995         
<a name="l00996"></a>00996         _shadowView = [[<a class="code" href="class_c_p_view.html">CPView</a> alloc] initWithFrame:CGRectMake(-SHADOW_MARGIN_LEFT, -SHADOW_MARGIN_TOP + SHADOW_DISTANCE, 
<a name="l00997"></a>00997             SHADOW_MARGIN_LEFT + CGRectGetWidth(bounds) + SHADOW_MARGIN_RIGHT, SHADOW_MARGIN_TOP + CGRectGetHeight(bounds) + SHADOW_MARGIN_BOTTOM)];
<a name="l00998"></a>00998     
<a name="l00999"></a>00999         <span class="keywordflow">if</span> (!_CPWindowShadowColor)
<a name="l01000"></a>01000         {
<a name="l01001"></a>01001             var bundle = [<a class="code" href="class_c_p_bundle.html" title="Groups information about an application&amp;#39;s code &amp;amp; resources.">CPBundle</a> <a class="code" href="class_c_p_bundle.html#a6b2401dce4d84d49261126169d966567">bundleForClass</a>:[<a class="code" href="class_c_p_window.html">CPWindow</a> class]];
<a name="l01002"></a>01002 
<a name="l01003"></a>01003             _CPWindowShadowColor = [CPColor colorWithPatternImage:[[<a class="code" href="class_c_p_nine_part_image.html">CPNinePartImage</a> alloc] initWithImageSlices:
<a name="l01004"></a>01004                 [
<a name="l01005"></a>01005                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow0.png&quot;] size:CGSizeMake(20.0, 19.0)],
<a name="l01006"></a>01006                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow1.png&quot;] size:CGSizeMake(1.0, 19.0)],
<a name="l01007"></a>01007                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow2.png&quot;] size:CGSizeMake(19.0, 19.0)],
<a name="l01008"></a>01008 
<a name="l01009"></a>01009                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow3.png&quot;] size:CGSizeMake(20.0, 1.0)],
<a name="l01010"></a>01010                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow4.png&quot;] size:CGSizeMake(1.0, 1.0)],
<a name="l01011"></a>01011                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow5.png&quot;] size:CGSizeMake(19.0, 1.0)],
<a name="l01012"></a>01012 
<a name="l01013"></a>01013                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow6.png&quot;] size:CGSizeMake(20.0, 18.0)],
<a name="l01014"></a>01014                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow7.png&quot;] size:CGSizeMake(1.0, 18.0)],
<a name="l01015"></a>01015                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow8.png&quot;] size:CGSizeMake(19.0, 18.0)]
<a name="l01016"></a>01016                 ]]];
<a name="l01017"></a>01017         }
<a name="l01018"></a>01018 
<a name="l01019"></a>01019         [_shadowView setBackgroundColor:_CPWindowShadowColor];
<a name="l01020"></a>01020         [_shadowView setAutoresizingMask:CPViewWidthSizable | CPViewHeightSizable];
<a name="l01021"></a>01021         
<a name="l01022"></a>01022 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l01023"></a>01023 <span class="preprocessor"></span>        <a class="code" href="_c_p_d_o_m_display_server_8h.html#a1aa00c9df58c03e393d941e22b99b576">CPDOMDisplayServerInsertBefore</a>(_DOMElement, _shadowView._DOMElement, _windowView._DOMElement);
<a name="l01024"></a>01024 <span class="preprocessor">#endif</span>
<a name="l01025"></a>01025 <span class="preprocessor"></span>    }
<a name="l01026"></a>01026     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!_hasShadow &amp;&amp; _shadowView)
<a name="l01027"></a>01027     {
<a name="l01028"></a>01028 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l01029"></a>01029 <span class="preprocessor"></span>        <a class="code" href="_c_p_d_o_m_display_server_8h.html#a516e8fe3a142194da3a9aa3cc9da1130">CPDOMDisplayServerRemoveChild</a>(_DOMElement, _shadowView._DOMElement);
<a name="l01030"></a>01030 <span class="preprocessor">#endif</span>
<a name="l01031"></a>01031 <span class="preprocessor"></span>        _shadowView = nil;
<a name="l01032"></a>01032     }
<a name="l01033"></a>01033 }
<a name="l01034"></a>01034 
<a name="l01039"></a><a class="code" href="class_c_p_window.html#ab620f96fdedb91ae99a95eee0b3ff84b">01039</a> - (void)setHasShadow:(BOOL)shouldHaveShadow
<a name="l01040"></a>01040 {
<a name="l01041"></a>01041     <span class="keywordflow">if</span> (_hasShadow === shouldHaveShadow)
<a name="l01042"></a>01042         <span class="keywordflow">return</span>;
<a name="l01043"></a>01043 
<a name="l01044"></a>01044     _hasShadow = shouldHaveShadow;
<a name="l01045"></a>01045 
<a name="l01046"></a>01046     [<span class="keyword">self</span> _updateShadow];
<a name="l01047"></a>01047 }
<a name="l01048"></a>01048 
<a name="l01049"></a><a class="code" href="class_c_p_window.html#aa9283399660ddb1231b3f9e6bccab625">01049</a> - (void)setShadowStyle:(<span class="keywordtype">unsigned</span>)aStyle
<a name="l01050"></a>01050 {
<a name="l01051"></a>01051     _shadowStyle = aStyle;
<a name="l01052"></a>01052 
<a name="l01053"></a>01053     [[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a0aefd4e1b2119ed015fcf990b3f167b5">platformWindow</a>] <a class="code" href="class_c_p_platform_window.html#ab281d7a4c1dc8b6312020e0afb28c211">setShadowStyle</a>:_shadowStyle];
<a name="l01054"></a>01054 }
<a name="l01055"></a>01055 
<a name="l01060"></a><a class="code" href="class_c_p_window.html#af48d93f6f967c70b46203f7bfacabf18">01060</a> - (void)setDelegate:(<span class="keywordtype">id</span>)aDelegate
<a name="l01061"></a>01061 {
<a name="l01062"></a>01062     <span class="comment">// FIXME: Unregister for notifications!</span>
<a name="l01063"></a>01063 
<a name="l01064"></a>01064     _delegate = aDelegate;
<a name="l01065"></a>01065     
<a name="l01066"></a>01066     _delegateRespondsToWindowWillReturnUndoManagerSelector = [_delegate respondsToSelector:@selector(windowWillReturnUndoManager:)];
<a name="l01067"></a>01067 
<a name="l01068"></a>01068     var defaultCenter = [<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>];
<a name="l01069"></a>01069     
<a name="l01070"></a>01070     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowDidBecomeMain:)])
<a name="l01071"></a>01071         [defaultCenter
<a name="l01072"></a>01072             addObserver:_delegate
<a name="l01073"></a>01073                selector:@selector(windowDidBecomeMain:)
<a name="l01074"></a>01074                    name:CPWindowDidBecomeMainNotification
<a name="l01075"></a>01075                  object:self];
<a name="l01076"></a>01076 
<a name="l01077"></a>01077     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowDidResignMain:)])
<a name="l01078"></a>01078         [defaultCenter
<a name="l01079"></a>01079             addObserver:_delegate
<a name="l01080"></a>01080                selector:@selector(windowDidResignMain:)
<a name="l01081"></a>01081                    name:CPWindowDidResignMainNotification
<a name="l01082"></a>01082                  object:self];
<a name="l01083"></a>01083 
<a name="l01084"></a>01084     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowDidMove:)])
<a name="l01085"></a>01085         [defaultCenter
<a name="l01086"></a>01086             addObserver:_delegate
<a name="l01087"></a>01087                selector:@selector(windowDidMove:)
<a name="l01088"></a>01088                    name:CPWindowDidMoveNotification
<a name="l01089"></a>01089                  object:self];
<a name="l01090"></a>01090 
<a name="l01091"></a>01091     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowDidResize:)])
<a name="l01092"></a>01092         [defaultCenter
<a name="l01093"></a>01093             addObserver:_delegate
<a name="l01094"></a>01094                selector:@selector(windowDidResize:)
<a name="l01095"></a>01095                    name:CPWindowDidResizeNotification
<a name="l01096"></a>01096                  object:self];
<a name="l01097"></a>01097 }
<a name="l01098"></a>01098 
<a name="l01102"></a><a class="code" href="class_c_p_window.html#a8622589fd16eef8183794a3702d687fa">01102</a> - (id)delegate
<a name="l01103"></a>01103 {
<a name="l01104"></a>01104     <span class="keywordflow">return</span> _delegate;
<a name="l01105"></a>01105 }
<a name="l01106"></a>01106 
<a name="l01111"></a><a class="code" href="class_c_p_window.html#a3b1dc79f277cbb1c0537bdf8236fef35">01111</a> - (void)setWindowController:(<a class="code" href="class_c_p_window_controller.html">CPWindowController</a>)aWindowController
<a name="l01112"></a>01112 {
<a name="l01113"></a>01113     _windowController = aWindowController;
<a name="l01114"></a>01114 }
<a name="l01115"></a>01115 
<a name="l01119"></a><a class="code" href="class_c_p_window.html#a4e0b69f32847e5eb911065d2e8ecdd40">01119</a> - (<a class="code" href="class_c_p_window_controller.html">CPWindowController</a>)windowController
<a name="l01120"></a>01120 {
<a name="l01121"></a>01121     <span class="keywordflow">return</span> _windowController;
<a name="l01122"></a>01122 }
<a name="l01123"></a>01123 
<a name="l01124"></a><a class="code" href="class_c_p_window.html#a292db7974a7823aaaba1224107838e11">01124</a> - (void)doCommandBySelector:(<span class="keywordtype">SEL</span>)aSelector
<a name="l01125"></a>01125 {
<a name="l01126"></a>01126     <span class="keywordflow">if</span> ([_delegate respondsToSelector:aSelector])
<a name="l01127"></a>01127         [_delegate performSelector:aSelector];
<a name="l01128"></a>01128     <span class="keywordflow">else</span>
<a name="l01129"></a>01129         [<span class="keyword">super</span> doCommandBySelector:aSelector];
<a name="l01130"></a>01130 }
<a name="l01131"></a>01131 
<a name="l01132"></a><a class="code" href="class_c_p_window.html#a76f1ff51058c2920022da0268b40dde9">01132</a> - (BOOL)acceptsFirstResponder
<a name="l01133"></a>01133 {
<a name="l01134"></a>01134     <span class="keywordflow">return</span> YES;
<a name="l01135"></a>01135 }
<a name="l01136"></a>01136 
<a name="l01144"></a><a class="code" href="class_c_p_window.html#abaf02cdc9845e6ceb278b6fe6c4e0074">01144</a> - (void)makeFirstResponder:(<a class="code" href="class_c_p_responder.html">CPResponder</a>)aResponder
<a name="l01145"></a>01145 {
<a name="l01146"></a>01146     <span class="keywordflow">if</span> (_firstResponder == aResponder)
<a name="l01147"></a>01147         <span class="keywordflow">return</span> YES;
<a name="l01148"></a>01148 
<a name="l01149"></a>01149     <span class="keywordflow">if</span>(![_firstResponder resignFirstResponder])
<a name="l01150"></a>01150         <span class="keywordflow">return</span> NO;
<a name="l01151"></a>01151 
<a name="l01152"></a>01152     <span class="keywordflow">if</span>(!aResponder || ![aResponder acceptsFirstResponder] || ![aResponder becomeFirstResponder])
<a name="l01153"></a>01153     {
<a name="l01154"></a>01154         _firstResponder = <span class="keyword">self</span>;
<a name="l01155"></a>01155     
<a name="l01156"></a>01156         <span class="keywordflow">return</span> NO;
<a name="l01157"></a>01157     }
<a name="l01158"></a>01158 
<a name="l01159"></a>01159     _firstResponder = aResponder;
<a name="l01160"></a>01160 
<a name="l01161"></a>01161     <span class="keywordflow">return</span> YES;
<a name="l01162"></a>01162 }
<a name="l01163"></a>01163 
<a name="l01167"></a><a class="code" href="class_c_p_window.html#ae3af926d15fa7e76e98f18e2797ea345">01167</a> - (<a class="code" href="class_c_p_responder.html">CPResponder</a>)firstResponder
<a name="l01168"></a>01168 {
<a name="l01169"></a>01169     <span class="keywordflow">return</span> _firstResponder;
<a name="l01170"></a>01170 }
<a name="l01171"></a>01171 
<a name="l01172"></a><a class="code" href="class_c_p_window.html#a714e6001c4a5314a60d3f9f93f73bd0f">01172</a> - (BOOL)acceptsMouseMovedEvents
<a name="l01173"></a>01173 {
<a name="l01174"></a>01174     <span class="keywordflow">return</span> _acceptsMouseMovedEvents;
<a name="l01175"></a>01175 }
<a name="l01176"></a>01176 
<a name="l01177"></a><a class="code" href="class_c_p_window.html#a2962fc840401f54afddc4db77fbf6076">01177</a> - (void)setAcceptsMouseMovedEvents:(BOOL)shouldAcceptMouseMovedEvents
<a name="l01178"></a>01178 {
<a name="l01179"></a>01179     _acceptsMouseMovedEvents = shouldAcceptMouseMovedEvents;
<a name="l01180"></a>01180 }
<a name="l01181"></a>01181 
<a name="l01182"></a><a class="code" href="class_c_p_window.html#a762a53680e43bf848778642618d45003">01182</a> - (BOOL)ignoresMouseEvents
<a name="l01183"></a>01183 {
<a name="l01184"></a>01184     <span class="keywordflow">return</span> _ignoresMouseEvents;
<a name="l01185"></a>01185 }
<a name="l01186"></a>01186 
<a name="l01187"></a><a class="code" href="class_c_p_window.html#a53cb5c76301222813be7fea88b7a7022">01187</a> - (void)setIgnoresMouseEvents:(BOOL)shouldIgnoreMouseEvents
<a name="l01188"></a>01188 {
<a name="l01189"></a>01189     _ignoresMouseEvents = shouldIgnoreMouseEvents;
<a name="l01190"></a>01190 }
<a name="l01191"></a>01191 
<a name="l01192"></a>01192 <span class="comment">// Managing Titles</span>
<a name="l01193"></a>01193 
<a name="l01197"></a><a class="code" href="class_c_p_window.html#a463f8f02036d1b07c639164f0cfebe6b">01197</a> - (<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)title
<a name="l01198"></a>01198 {
<a name="l01199"></a>01199     <span class="keywordflow">return</span> _title;
<a name="l01200"></a>01200 }
<a name="l01201"></a>01201 
<a name="l01205"></a><a class="code" href="class_c_p_window.html#ad0672968510870de1b33985dd17c5c8e">01205</a> - (void)setTitle:(<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)aTitle
<a name="l01206"></a>01206 {
<a name="l01207"></a>01207     _title = aTitle;
<a name="l01208"></a>01208     
<a name="l01209"></a>01209     [_windowView setTitle:aTitle];
<a name="l01210"></a>01210     
<a name="l01211"></a>01211     [<span class="keyword">self</span> _synchronizeMenuBarTitleWithWindowTitle];
<a name="l01212"></a>01212 }
<a name="l01213"></a>01213 
<a name="l01217"></a><a class="code" href="class_c_p_window.html#ae5edca41e0f08be59c198b684703733d">01217</a> - (void)setTitleWithRepresentedFilename:(<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)aFilePath
<a name="l01218"></a>01218 {
<a name="l01219"></a>01219     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ae32de1160f3749c7b3b6790d2745ec96">setRepresentedFilename</a>:aFilePath];
<a name="l01220"></a>01220     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ad0672968510870de1b33985dd17c5c8e">setTitle</a>:[aFilePath <a class="code" href="class_c_p_string.html#ae3defdd5560a6206b6fc975194fb5fc6">lastPathComponent</a>]];
<a name="l01221"></a>01221 }
<a name="l01222"></a>01222 
<a name="l01226"></a><a class="code" href="class_c_p_window.html#ae32de1160f3749c7b3b6790d2745ec96">01226</a> - (void)setRepresentedFilename:(<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)aFilePath
<a name="l01227"></a>01227 {
<a name="l01228"></a>01228     <span class="comment">// FIXME: urls vs filepaths and all.</span>
<a name="l01229"></a>01229     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a1ea7de7732a0e36ec126e35d0f329dd6">setRepresentedURL</a>:aFilePath];
<a name="l01230"></a>01230 }
<a name="l01231"></a>01231 
<a name="l01235"></a><a class="code" href="class_c_p_window.html#ab56377d2c61fdbf17ef33976f9bfd70c">01235</a> - (<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)representedFilename
<a name="l01236"></a>01236 {
<a name="l01237"></a>01237     <span class="keywordflow">return</span> _representedURL;
<a name="l01238"></a>01238 }
<a name="l01239"></a>01239 
<a name="l01243"></a><a class="code" href="class_c_p_window.html#a1ea7de7732a0e36ec126e35d0f329dd6">01243</a> - (void)setRepresentedURL:(<a class="code" href="class_c_p_u_r_l.html">CPURL</a>)aURL
<a name="l01244"></a>01244 {
<a name="l01245"></a>01245     _representedURL = aURL;
<a name="l01246"></a>01246 }
<a name="l01247"></a>01247 
<a name="l01251"></a><a class="code" href="class_c_p_window.html#a53f43613ff02e2d46b710aacf5545452">01251</a> - (<a class="code" href="class_c_p_u_r_l.html">CPURL</a>)representedURL
<a name="l01252"></a>01252 {
<a name="l01253"></a>01253     <span class="keywordflow">return</span> _representedURL;
<a name="l01254"></a>01254 }
<a name="l01255"></a>01255 
<a name="l01256"></a><a class="code" href="class_c_p_window.html#abf80bb635d843f19d8ced7385e0bdd38">01256</a> - (<a class="code" href="class_c_p_screen.html">CPScreen</a>)screen
<a name="l01257"></a>01257 {
<a name="l01258"></a>01258     <span class="keywordflow">return</span> [[<a class="code" href="class_c_p_screen.html">CPScreen</a> alloc] init];
<a name="l01259"></a>01259 }
<a name="l01260"></a>01260 
<a name="l01261"></a>01261 <span class="comment">// Moving</span>
<a name="l01262"></a>01262 
<a name="l01267"></a><a class="code" href="class_c_p_window.html#a4b299e3f1ade652283bce1f6c8e71b66">01267</a> - (void)setMovableByWindowBackground:(BOOL)shouldBeMovableByWindowBackground
<a name="l01268"></a>01268 {
<a name="l01269"></a>01269     _isMovableByWindowBackground = shouldBeMovableByWindowBackground;
<a name="l01270"></a>01270 }
<a name="l01271"></a>01271 
<a name="l01275"></a><a class="code" href="class_c_p_window.html#a850434b623ef87e37e6a45599652b4b6">01275</a> - (BOOL)isMovableByWindowBackground
<a name="l01276"></a>01276 {
<a name="l01277"></a>01277     <span class="keywordflow">return</span> _isMovableByWindowBackground;
<a name="l01278"></a>01278 }
<a name="l01279"></a>01279 
<a name="l01283"></a><a class="code" href="class_c_p_window.html#a7e4e5ae86bee1664fbda5e077016b1d0">01283</a> - (void)center
<a name="l01284"></a>01284 {
<a name="l01285"></a>01285     var <a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a> = [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a0eddef926f318eecaf793e702be6d5a5">frame</a>].size,
<a name="l01286"></a>01286         containerSize = [<a class="code" href="class_c_p_platform.html">CPPlatform</a> <a class="code" href="class_c_p_platform.html#add8d61d0f32ef6cac1102f1e1c70db78">isBrowser</a>] ? [_platformWindow contentBounds].size : [[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#abf80bb635d843f19d8ced7385e0bdd38">screen</a>] visibleFrame].size;
<a name="l01287"></a>01287 
<a name="l01288"></a>01288     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#af2c6d92c09cf5c4e3cb79e95a8487a4a">setFrameOrigin</a>:CGPointMake((containerSize.width - size.width) / 2.0, (containerSize.height - size.height) / 2.0)];
<a name="l01289"></a>01289 }
<a name="l01290"></a>01290 
<a name="l01295"></a><a class="code" href="class_c_p_window.html#a15c9ee5f8df2e0c2f575e663d3959c21">01295</a> - (void)sendEvent:(<a class="code" href="class_c_p_event.html">CPEvent</a>)anEvent
<a name="l01296"></a>01296 {
<a name="l01297"></a>01297     var type = [anEvent <a class="code" href="class_c_p_event.html#abbbd5ff6550996fa3ef524ef27a1ef80">type</a>],
<a name="l01298"></a>01298         point = [anEvent <a class="code" href="class_c_p_event.html#a5a57f4fa909de5d83e5402a8d8af4b94">locationInWindow</a>];
<a name="l01299"></a>01299 
<a name="l01300"></a>01300     <span class="keywordflow">switch</span> (type)
<a name="l01301"></a>01301     {
<a name="l01302"></a>01302         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a2d5100bbd68b5192c640acc7c6b48764">CPKeyUp</a>:               <span class="keywordflow">return</span> [[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ae3af926d15fa7e76e98f18e2797ea345">firstResponder</a>] <a class="code" href="class_c_p_responder.html#a6dfd1be3af74ea2b732205d06982ebfe">keyUp</a>:anEvent];
<a name="l01303"></a>01303         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a44b7200967c244a014e1ee34ad02ecd9">CPKeyDown</a>:             <span class="keywordflow">return</span> [[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ae3af926d15fa7e76e98f18e2797ea345">firstResponder</a>] <a class="code" href="class_c_p_responder.html#ab79a1f20ad2061e44fcf08ced0e2d391">keyDown</a>:anEvent];
<a name="l01304"></a>01304 
<a name="l01305"></a>01305         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a27aba2fa2e11afafa2725dd5a177b35e">CPScrollWheel</a>:         <span class="keywordflow">return</span> [[_windowView hitTest:point] scrollWheel:anEvent];
<a name="l01306"></a>01306 
<a name="l01307"></a>01307         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a192f15362855840eb6cfb4177a6494ef">CPLeftMouseUp</a>:         <span class="keywordflow">if</span> (!_leftMouseDownView)
<a name="l01308"></a>01308                                         <span class="keywordflow">return</span> [[_windowView hitTest:point] mouseUp:anEvent];
<a name="l01309"></a>01309 
<a name="l01310"></a>01310                                     [_leftMouseDownView mouseUp:anEvent]
<a name="l01311"></a>01311 
<a name="l01312"></a>01312                                     _leftMouseDownView = nil;
<a name="l01313"></a>01313 
<a name="l01314"></a>01314                                     <span class="keywordflow">return</span>;
<a name="l01315"></a>01315         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a1e3613de4780ff7b45bace27a1521899">CPLeftMouseDown</a>:       _leftMouseDownView = [_windowView hitTest:point];
<a name="l01316"></a>01316 
<a name="l01317"></a>01317                                     <span class="keywordflow">if</span> (_leftMouseDownView != _firstResponder &amp;&amp; [_leftMouseDownView acceptsFirstResponder])
<a name="l01318"></a>01318                                         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#abaf02cdc9845e6ceb278b6fe6c4e0074">makeFirstResponder</a>:_leftMouseDownView];
<a name="l01319"></a>01319 
<a name="l01320"></a>01320                                     [CPApp activateIgnoringOtherApps:YES];
<a name="l01321"></a>01321 
<a name="l01322"></a>01322                                     var theWindow = [anEvent <a class="code" href="class_c_p_event.html#af9a0e45bbaba9bc6587a222e74bf0703">window</a>];
<a name="l01323"></a>01323 
<a name="l01324"></a>01324                                     <span class="keywordflow">if</span> ([theWindow isKeyWindow] || [theWindow becomesKeyOnlyIfNeeded])
<a name="l01325"></a>01325                                         <span class="keywordflow">return</span> [_leftMouseDownView mouseDown:anEvent];
<a name="l01326"></a>01326                                     <span class="keywordflow">else</span>
<a name="l01327"></a>01327                                     {
<a name="l01328"></a>01328                                         <span class="comment">// FIXME: delayed ordering?</span>
<a name="l01329"></a>01329                                         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a53710ab84e1e114f090cd75d6a47033f">makeKeyAndOrderFront</a>:self];
<a name="l01330"></a>01330 
<a name="l01331"></a>01331                                         <span class="keywordflow">if</span> ([_leftMouseDownView acceptsFirstMouse:anEvent])
<a name="l01332"></a>01332                                             <span class="keywordflow">return</span> [_leftMouseDownView mouseDown:anEvent]
<a name="l01333"></a>01333                                     }
<a name="l01334"></a>01334                                     <span class="keywordflow">break</span>;
<a name="l01335"></a>01335         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a391b5492a8cbdfa1b84b349eb2120c4e">CPLeftMouseDragged</a>:    <span class="keywordflow">if</span> (!_leftMouseDownView)
<a name="l01336"></a>01336                                         <span class="keywordflow">return</span> [[_windowView hitTest:point] mouseDragged:anEvent];
<a name="l01337"></a>01337 
<a name="l01338"></a>01338                                     <span class="keywordflow">return</span> [_leftMouseDownView mouseDragged:anEvent];
<a name="l01339"></a>01339         
<a name="l01340"></a>01340         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#ad01d8900a24d2f095d84e3e08d36c937">CPRightMouseUp</a>:        <span class="keywordflow">return</span> [_rightMouseDownView mouseUp:anEvent];
<a name="l01341"></a>01341         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#af7881703a39edf5c57b0e51ed6123d49">CPRightMouseDown</a>:      _rightMouseDownView = [_windowView hitTest:point];
<a name="l01342"></a>01342                                     <span class="keywordflow">return</span> [_rightMouseDownView mouseDown:anEvent];
<a name="l01343"></a>01343         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a1fadebaac82052428820fc0da9eceaa5">CPRightMouseDragged</a>:   <span class="keywordflow">return</span> [_rightMouseDownView mouseDragged:anEvent];
<a name="l01344"></a>01344         
<a name="l01345"></a>01345         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a5bdb3919044bdb124c16292b9e50f615">CPMouseMoved</a>:          <span class="keywordflow">if</span> (!_acceptsMouseMovedEvents)
<a name="l01346"></a>01346                                         <span class="keywordflow">return</span>;
<a name="l01347"></a>01347 
<a name="l01348"></a>01348                                     <span class="keywordflow">if</span> (!_mouseEnteredStack)
<a name="l01349"></a>01349                                         _mouseEnteredStack = [];
<a name="l01350"></a>01350 
<a name="l01351"></a>01351                                     var hitTestView = [_windowView hitTest:point];
<a name="l01352"></a>01352 
<a name="l01353"></a>01353                                     <span class="keywordflow">if</span> ([_mouseEnteredStack count] &amp;&amp; [_mouseEnteredStack lastObject] === hitTestView)
<a name="l01354"></a>01354                                         <span class="keywordflow">return</span> [hitTestView mouseMoved:anEvent];
<a name="l01355"></a>01355 
<a name="l01356"></a>01356                                     var view = hitTestView,
<a name="l01357"></a>01357                                         mouseEnteredStack = [];
<a name="l01358"></a>01358 
<a name="l01359"></a>01359                                     <span class="keywordflow">while</span> (view)
<a name="l01360"></a>01360                                     {
<a name="l01361"></a>01361                                         mouseEnteredStack.unshift(view);
<a name="l01362"></a>01362 
<a name="l01363"></a>01363                                         view = [view superview];
<a name="l01364"></a>01364                                     }
<a name="l01365"></a>01365 
<a name="l01366"></a>01366                                     var deviation = <a class="code" href="_c_p_obj_j_runtime_8j.html#a4fca277171215842609dc38a6f0c19fb">MIN</a>(_mouseEnteredStack.length, mouseEnteredStack.length);
<a name="l01367"></a>01367 
<a name="l01368"></a>01368                                     <span class="keywordflow">while</span> (deviation--)
<a name="l01369"></a>01369                                         <span class="keywordflow">if</span> (_mouseEnteredStack[deviation] === mouseEnteredStack[deviation])
<a name="l01370"></a>01370                                             <span class="keywordflow">break</span>;
<a name="l01371"></a>01371 
<a name="l01372"></a>01372                                     var index = deviation + 1,
<a name="l01373"></a>01373                                         count = _mouseEnteredStack.length;
<a name="l01374"></a>01374 
<a name="l01375"></a>01375                                     <span class="keywordflow">if</span> (index &lt; count)
<a name="l01376"></a>01376                                     {
<a name="l01377"></a>01377                                         var <span class="keyword">event</span> = [<a class="code" href="class_c_p_event.html">CPEvent</a> <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">mouseEventWithType</a>:CPMouseExited <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">location</a>:point <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">modifierFlags</a>:[anEvent <a class="code" href="class_c_p_event.html#ae1990580a2f73b19009f30f27ff1e396">modifierFlags</a>] <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">timestamp</a>:[anEvent <a class="code" href="class_c_p_event.html#ab290762686ceda8bb462e0e989f62e04">timestamp</a>] <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">windowNumber</a>:_windowNumber <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">context</a>:nil <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">eventNumber</a>:-1 <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">clickCount</a>:1 <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">pressure</a>:0];
<a name="l01378"></a>01378 
<a name="l01379"></a>01379                                         <span class="keywordflow">for</span> (; index &lt; count; ++index)
<a name="l01380"></a>01380                                             [_mouseEnteredStack[index] mouseExited:event];
<a name="l01381"></a>01381                                     }
<a name="l01382"></a>01382 
<a name="l01383"></a>01383                                     index = deviation + 1;
<a name="l01384"></a>01384                                     count = mouseEnteredStack.length;
<a name="l01385"></a>01385 
<a name="l01386"></a>01386                                     <span class="keywordflow">if</span> (index &lt; count)
<a name="l01387"></a>01387                                     {
<a name="l01388"></a>01388                                         var <span class="keyword">event</span> = [<a class="code" href="class_c_p_event.html">CPEvent</a> <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">mouseEventWithType</a>:CPMouseEntered <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">location</a>:point <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">modifierFlags</a>:[anEvent <a class="code" href="class_c_p_event.html#ae1990580a2f73b19009f30f27ff1e396">modifierFlags</a>] <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">timestamp</a>:[anEvent <a class="code" href="class_c_p_event.html#ab290762686ceda8bb462e0e989f62e04">timestamp</a>] <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">windowNumber</a>:_windowNumber <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">context</a>:nil <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">eventNumber</a>:-1 <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">clickCount</a>:1 <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">pressure</a>:0];
<a name="l01389"></a>01389 
<a name="l01390"></a>01390                                         <span class="keywordflow">for</span> (; index &lt; count; ++index)
<a name="l01391"></a>01391                                             [mouseEnteredStack[index] mouseEntered:event];
<a name="l01392"></a>01392                                     }
<a name="l01393"></a>01393 
<a name="l01394"></a>01394                                     _mouseEnteredStack = mouseEnteredStack;
<a name="l01395"></a>01395 
<a name="l01396"></a>01396                                     [hitTestView mouseMoved:anEvent];
<a name="l01397"></a>01397     }
<a name="l01398"></a>01398 }
<a name="l01399"></a>01399 
<a name="l01403"></a><a class="code" href="class_c_p_window.html#aca95f3e1077a7b8859badba268fabbec">01403</a> - (int)windowNumber
<a name="l01404"></a>01404 {
<a name="l01405"></a>01405     <span class="keywordflow">return</span> _windowNumber;
<a name="l01406"></a>01406 }
<a name="l01407"></a>01407 
<a name="l01412"></a><a class="code" href="class_c_p_window.html#a3cab8fa3cb78d27fbb996b460056a886">01412</a> - (void)becomeKeyWindow
<a name="l01413"></a>01413 {
<a name="l01414"></a>01414     <span class="keywordflow">if</span> (_firstResponder != <span class="keyword">self</span> &amp;&amp; [_firstResponder respondsToSelector:<span class="keyword">@selector</span>(becomeKeyWindow)])
<a name="l01415"></a>01415         [_firstResponder becomeKeyWindow];
<a name="l01416"></a>01416 }
<a name="l01417"></a>01417 
<a name="l01422"></a><a class="code" href="class_c_p_window.html#a25ceeb80ee62f143cf34adae95b39634">01422</a> - (BOOL)canBecomeKeyWindow
<a name="l01423"></a>01423 {
<a name="l01424"></a>01424     <span class="keywordflow">return</span> YES;
<a name="l01425"></a>01425 }
<a name="l01426"></a>01426 
<a name="l01430"></a><a class="code" href="class_c_p_window.html#ab7bb73cd5147bdc16b16d678ec91673e">01430</a> - (BOOL)isKeyWindow
<a name="l01431"></a>01431 {
<a name="l01432"></a>01432     <span class="keywordflow">return</span> [CPApp keyWindow] == <span class="keyword">self</span>;
<a name="l01433"></a>01433 }
<a name="l01434"></a>01434 
<a name="l01439"></a><a class="code" href="class_c_p_window.html#a53710ab84e1e114f090cd75d6a47033f">01439</a> - (void)makeKeyAndOrderFront:(<span class="keywordtype">id</span>)aSender
<a name="l01440"></a>01440 {
<a name="l01441"></a>01441     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a4c3bebfd3f9b356fe3528f8697e95b0a">orderFront</a>:self];
<a name="l01442"></a>01442     
<a name="l01443"></a>01443     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a7e1d3d1abeac1feca2a1f9fd07ac37c1">makeKeyWindow</a>];
<a name="l01444"></a>01444     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a9ee2b9bd46241094df06934173c19d48">makeMainWindow</a>];
<a name="l01445"></a>01445 }
<a name="l01446"></a>01446 
<a name="l01450"></a><a class="code" href="class_c_p_window.html#a7e1d3d1abeac1feca2a1f9fd07ac37c1">01450</a> - (void)makeKeyWindow
<a name="l01451"></a>01451 {
<a name="l01452"></a>01452     <span class="keywordflow">if</span> (![<span class="keyword">self</span> canBecomeKeyWindow])
<a name="l01453"></a>01453         <span class="keywordflow">return</span>;
<a name="l01454"></a>01454 
<a name="l01455"></a>01455     [CPApp._keyWindow resignKeyWindow];
<a name="l01456"></a>01456     
<a name="l01457"></a>01457     <a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a>._keyWindow = <span class="keyword">self</span>;
<a name="l01458"></a>01458     
<a name="l01459"></a>01459     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a3cab8fa3cb78d27fbb996b460056a886">becomeKeyWindow</a>];
<a name="l01460"></a>01460 }
<a name="l01461"></a>01461 
<a name="l01465"></a><a class="code" href="class_c_p_window.html#a7eccad1de6cc0ca8c23dae1d4eeca57c">01465</a> - (void)resignKeyWindow
<a name="l01466"></a>01466 {
<a name="l01467"></a>01467     <span class="keywordflow">if</span> (_firstResponder != <span class="keyword">self</span> &amp;&amp; [_firstResponder respondsToSelector:<span class="keyword">@selector</span>(resignKeyWindow)])
<a name="l01468"></a>01468         [_firstResponder resignKeyWindow];
<a name="l01469"></a>01469     
<a name="l01470"></a>01470     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowDidResignKey:)])
<a name="l01471"></a>01471         [_delegate windowDidResignKey:self];
<a name="l01472"></a>01472 }
<a name="l01473"></a>01473 
<a name="l01484"></a><a class="code" href="class_c_p_window.html#a8fa9719d87138612b70e39e49990cf75">01484</a> - (void)dragImage:(<a class="code" href="class_c_p_image.html">CPImage</a>)anImage at:(CGPoint)imageLocation offset:(CGSize)mouseOffset event:(<a class="code" href="class_c_p_event.html">CPEvent</a>)anEvent pasteboard:(<a class="code" href="class_c_p_pasteboard.html">CPPasteboard</a>)aPasteboard source:(<span class="keywordtype">id</span>)aSourceObject slideBack:(BOOL)slideBack
<a name="l01485"></a>01485 {
<a name="l01486"></a>01486     [[<a class="code" href="class_c_p_drag_server.html">CPDragServer</a> <a class="code" href="class_c_p_drag_server.html#a052f4e44c024c5ee0949db705b10d3a0">sharedDragServer</a>] <a class="code" href="class_c_p_drag_server.html#a9d8993ce974a99977d1d99e87d61985a">dragImage</a>:anImage <a class="code" href="class_c_p_drag_server.html#a9d8993ce974a99977d1d99e87d61985a">fromWindow</a>:self <a class="code" href="class_c_p_drag_server.html#a9d8993ce974a99977d1d99e87d61985a">at</a>:[<span class="keyword">self</span> convertBaseToGlobal:imageLocation] <a class="code" href="class_c_p_drag_server.html#a9d8993ce974a99977d1d99e87d61985a">offset</a>:mouseOffset <a class="code" href="class_c_p_drag_server.html#a9d8993ce974a99977d1d99e87d61985a">event</a>:anEvent <a class="code" href="class_c_p_drag_server.html#a9d8993ce974a99977d1d99e87d61985a">pasteboard</a>:aPasteboard <a class="code" href="class_c_p_drag_server.html#a9d8993ce974a99977d1d99e87d61985a">source</a>:aSourceObject <a class="code" href="class_c_p_drag_server.html#a9d8993ce974a99977d1d99e87d61985a">slideBack</a>:slideBack];
<a name="l01487"></a>01487 }
<a name="l01488"></a>01488 
<a name="l01489"></a>01489 - (void)_noteRegisteredDraggedTypes:(<a class="code" href="class_c_p_set.html" title="An unordered collection of objects.">CPSet</a>)pasteboardTypes
<a name="l01490"></a>01490 {
<a name="l01491"></a>01491     <span class="keywordflow">if</span> (!pasteboardTypes)
<a name="l01492"></a>01492         <span class="keywordflow">return</span>;
<a name="l01493"></a>01493 
<a name="l01494"></a>01494     <span class="keywordflow">if</span> (!_inclusiveRegisteredDraggedTypes)
<a name="l01495"></a>01495         _inclusiveRegisteredDraggedTypes = [<a class="code" href="class_c_p_counted_set.html" title="An mutable collection which may contain a specific object numerous times.">CPCountedSet</a> set];
<a name="l01496"></a>01496 
<a name="l01497"></a>01497     [_inclusiveRegisteredDraggedTypes unionSet:pasteboardTypes];
<a name="l01498"></a>01498 }
<a name="l01499"></a>01499 
<a name="l01500"></a>01500 - (void)_noteUnregisteredDraggedTypes:(<a class="code" href="class_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript...">CPArray</a>)pasteboardTypes
<a name="l01501"></a>01501 {
<a name="l01502"></a>01502     <span class="keywordflow">if</span> (!pasteboardTypes)
<a name="l01503"></a>01503         <span class="keywordflow">return</span>;
<a name="l01504"></a>01504 
<a name="l01505"></a>01505     [_inclusiveRegisteredDraggedTypes minusSet:pasteboardTypes]
<a name="l01506"></a>01506 
<a name="l01507"></a>01507     <span class="keywordflow">if</span> ([_inclusiveRegisteredDraggedTypes count] === 0)
<a name="l01508"></a>01508         _inclusiveRegisteredDraggedTypes = nil;
<a name="l01509"></a>01509 }
<a name="l01510"></a>01510 
<a name="l01521"></a><a class="code" href="class_c_p_window.html#a06ffa5f6d3d49f1a65486578b02fc940">01521</a> - (void)dragView:(<a class="code" href="class_c_p_view.html">CPView</a>)aView at:(CGPoint)viewLocation offset:(CGSize)mouseOffset event:(<a class="code" href="class_c_p_event.html">CPEvent</a>)anEvent pasteboard:(<a class="code" href="class_c_p_pasteboard.html">CPPasteboard</a>)aPasteboard source:(<span class="keywordtype">id</span>)aSourceObject slideBack:(BOOL)slideBack
<a name="l01522"></a>01522 {
<a name="l01523"></a>01523     [[<a class="code" href="class_c_p_drag_server.html">CPDragServer</a> <a class="code" href="class_c_p_drag_server.html#a052f4e44c024c5ee0949db705b10d3a0">sharedDragServer</a>] <a class="code" href="class_c_p_drag_server.html#ab3c1fdf59eb047cf404bf99ebe6298fc">dragView</a>:aView <a class="code" href="class_c_p_drag_server.html#ab3c1fdf59eb047cf404bf99ebe6298fc">fromWindow</a>:self <a class="code" href="class_c_p_drag_server.html#ab3c1fdf59eb047cf404bf99ebe6298fc">at</a>:[<span class="keyword">self</span> convertBaseToGlobal:viewLocation] <a class="code" href="class_c_p_drag_server.html#ab3c1fdf59eb047cf404bf99ebe6298fc">offset</a>:mouseOffset <a class="code" href="class_c_p_drag_server.html#ab3c1fdf59eb047cf404bf99ebe6298fc">event</a>:anEvent <a class="code" href="class_c_p_drag_server.html#ab3c1fdf59eb047cf404bf99ebe6298fc">pasteboard</a>:aPasteboard <a class="code" href="class_c_p_drag_server.html#ab3c1fdf59eb047cf404bf99ebe6298fc">source</a>:aSourceObject <a class="code" href="class_c_p_drag_server.html#ab3c1fdf59eb047cf404bf99ebe6298fc">slideBack</a>:slideBack];
<a name="l01524"></a>01524 }
<a name="l01525"></a>01525 
<a name="l01530"></a><a class="code" href="class_c_p_window.html#a09143622a8bce3dbed5ddf871b40e89a">01530</a> - (void)registerForDraggedTypes:(<a class="code" href="class_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript...">CPArray</a>)pasteboardTypes
<a name="l01531"></a>01531 {
<a name="l01532"></a>01532     <span class="keywordflow">if</span> (!pasteboardTypes)
<a name="l01533"></a>01533         <span class="keywordflow">return</span>;
<a name="l01534"></a>01534 
<a name="l01535"></a>01535     [<span class="keyword">self</span> _noteUnregisteredDraggedTypes:_registeredDraggedTypes];
<a name="l01536"></a>01536     [_registeredDraggedTypes addObjectsFromArray:pasteboardTypes]
<a name="l01537"></a>01537     [<span class="keyword">self</span> _noteRegisteredDraggedTypes:_registeredDraggedTypes];
<a name="l01538"></a>01538 
<a name="l01539"></a>01539     _registeredDraggedTypesArray = nil;
<a name="l01540"></a>01540 }
<a name="l01541"></a>01541 
<a name="l01546"></a><a class="code" href="class_c_p_window.html#a9f16837f8fce108861c33f86f75ae4d1">01546</a> - (<a class="code" href="class_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript...">CPArray</a>)registeredDraggedTypes
<a name="l01547"></a>01547 {
<a name="l01548"></a>01548     <span class="keywordflow">if</span> (!_registeredDraggedTypesArray)
<a name="l01549"></a>01549         _registeredDraggedTypesArray = [_registeredDraggedTypes allObjects]
<a name="l01550"></a>01550 
<a name="l01551"></a>01551     <span class="keywordflow">return</span> _registeredDraggedTypesArray;
<a name="l01552"></a>01552 }
<a name="l01553"></a>01553 
<a name="l01557"></a><a class="code" href="class_c_p_window.html#aea19296d6bf76c61a3e3fb0e4618e59e">01557</a> - (void)unregisterDraggedTypes
<a name="l01558"></a>01558 {
<a name="l01559"></a>01559     [<span class="keyword">self</span> _noteUnregisteredDraggedTypes:_registeredDraggedTypes];
<a name="l01560"></a>01560 
<a name="l01561"></a>01561     _registeredDraggedTypes = [<a class="code" href="class_c_p_set.html" title="An unordered collection of objects.">CPSet</a> <a class="code" href="class_c_p_set.html#a89623be28c3a0913db1967b667874d39">set</a>];
<a name="l01562"></a>01562     _registeredDraggedTypesArray = [];
<a name="l01563"></a>01563 }
<a name="l01564"></a>01564 
<a name="l01565"></a>01565 <span class="comment">// Accessing Editing Status</span>
<a name="l01566"></a>01566 
<a name="l01571"></a><a class="code" href="class_c_p_window.html#a34f16e66b7d303aa677f49f2cb4f9e49">01571</a> - (void)setDocumentEdited:(BOOL)isDocumentEdited
<a name="l01572"></a>01572 {
<a name="l01573"></a>01573     <span class="keywordflow">if</span> (_isDocumentEdited == isDocumentEdited)
<a name="l01574"></a>01574         <span class="keywordflow">return</span>;
<a name="l01575"></a>01575     
<a name="l01576"></a>01576     _isDocumentEdited = isDocumentEdited;
<a name="l01577"></a>01577     
<a name="l01578"></a>01578     [<a class="code" href="class_c_p_menu.html">CPMenu</a> _setMenuBarIconImageAlphaValue:_isDocumentEdited ? 0.5 : 1.0];
<a name="l01579"></a>01579 
<a name="l01580"></a>01580     [_windowView setDocumentEdited:isDocumentEdited];
<a name="l01581"></a>01581 }
<a name="l01582"></a>01582 
<a name="l01586"></a><a class="code" href="class_c_p_window.html#a59619e4d7e9c3d4a0755a466fb16da31">01586</a> - (BOOL)isDocumentEdited
<a name="l01587"></a>01587 {
<a name="l01588"></a>01588     <span class="keywordflow">return</span> _isDocumentEdited;
<a name="l01589"></a>01589 }
<a name="l01590"></a>01590 
<a name="l01591"></a><a class="code" href="class_c_p_window.html#addbfd0b2c5307696366ab3a9e2d4fe4d">01591</a> - (void)setDocumentSaving:(BOOL)isDocumentSaving
<a name="l01592"></a>01592 {
<a name="l01593"></a>01593     <span class="keywordflow">if</span> (_isDocumentSaving == isDocumentSaving)
<a name="l01594"></a>01594         <span class="keywordflow">return</span>;
<a name="l01595"></a>01595     
<a name="l01596"></a>01596     _isDocumentSaving = isDocumentSaving;
<a name="l01597"></a>01597     
<a name="l01598"></a>01598     [<span class="keyword">self</span> _synchronizeSaveMenuWithDocumentSaving];
<a name="l01599"></a>01599     
<a name="l01600"></a>01600     [_windowView windowDidChangeDocumentSaving];
<a name="l01601"></a>01601 }
<a name="l01602"></a>01602 
<a name="l01603"></a><a class="code" href="class_c_p_window.html#aa8e5fe96d20aaedca3932234e6b3c775">01603</a> - (BOOL)isDocumentSaving
<a name="l01604"></a>01604 {
<a name="l01605"></a>01605     <span class="keywordflow">return</span> _isDocumentSaving;
<a name="l01606"></a>01606 }
<a name="l01607"></a>01607 
<a name="l01608"></a>01608 <span class="comment">/* @ignore */</span>
<a name="l01609"></a>01609 - (void)_synchronizeSaveMenuWithDocumentSaving
<a name="l01610"></a>01610 {
<a name="l01611"></a>01611     <span class="keywordflow">if</span> (![<span class="keyword">self</span> isMainWindow])
<a name="l01612"></a>01612         <span class="keywordflow">return</span>;
<a name="l01613"></a>01613 
<a name="l01614"></a>01614     var mainMenu = [CPApp mainMenu],
<a name="l01615"></a>01615         index = [mainMenu indexOfItemWithTitle:_isDocumentSaving ? @&quot;Save&quot; : @&quot;Saving...&quot;];
<a name="l01616"></a>01616         
<a name="l01617"></a>01617     <span class="keywordflow">if</span> (index == <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l01618"></a>01618         <span class="keywordflow">return</span>;
<a name="l01619"></a>01619     
<a name="l01620"></a>01620     var item = [mainMenu itemAtIndex:index];
<a name="l01621"></a>01621         
<a name="l01622"></a>01622     <span class="keywordflow">if</span> (_isDocumentSaving)
<a name="l01623"></a>01623     {
<a name="l01624"></a>01624         <a class="code" href="_c_p_window_8j.html#a51cefe6c4b9ce4b6f5f00509636cc76b">CPWindowSaveImage</a> = [item image];
<a name="l01625"></a>01625         
<a name="l01626"></a>01626         [item setTitle:@&quot;Saving...&quot;];
<a name="l01627"></a>01627         [item setImage:CPWindowSavingImage];
<a name="l01628"></a>01628         [item setEnabled:NO];
<a name="l01629"></a>01629     }
<a name="l01630"></a>01630     <span class="keywordflow">else</span>
<a name="l01631"></a>01631     {
<a name="l01632"></a>01632         [item setTitle:@&quot;Save&quot;];
<a name="l01633"></a>01633         [item setImage:CPWindowSaveImage];
<a name="l01634"></a>01634         [item setEnabled:YES];
<a name="l01635"></a>01635     }
<a name="l01636"></a>01636 }
<a name="l01637"></a>01637 
<a name="l01638"></a>01638 <span class="comment">// Minimizing Windows</span>
<a name="l01639"></a>01639 
<a name="l01644"></a><a class="code" href="class_c_p_window.html#ad13e2bfe7fe731ad58a30da62d5d56e9">01644</a> - (void)performMiniaturize:(<span class="keywordtype">id</span>)aSender
<a name="l01645"></a>01645 {
<a name="l01646"></a>01646     <span class="comment">//FIXME show stuff</span>
<a name="l01647"></a>01647     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a50b2f0691ab8b723cb9685536f2d6860">miniaturize</a>:aSender];
<a name="l01648"></a>01648 }
<a name="l01649"></a>01649 
<a name="l01654"></a><a class="code" href="class_c_p_window.html#a50b2f0691ab8b723cb9685536f2d6860">01654</a> - (void)miniaturize:(<span class="keywordtype">id</span>)sender
<a name="l01655"></a>01655 {
<a name="l01656"></a>01656     [[<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowWillMiniaturizeNotification <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l01657"></a>01657 
<a name="l01658"></a>01658     [[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a0aefd4e1b2119ed015fcf990b3f167b5">platformWindow</a>] <a class="code" href="class_c_p_platform_window.html#adb41d8972e36b0d18a8a8936648f4157">miniaturize</a>:sender];
<a name="l01659"></a>01659 
<a name="l01660"></a>01660     [[<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowDidMiniaturizeNotification <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l01661"></a>01661 
<a name="l01662"></a>01662     _isMiniaturized = YES;
<a name="l01663"></a>01663 }
<a name="l01664"></a>01664 
<a name="l01668"></a><a class="code" href="class_c_p_window.html#a0f4180b9d9254f3a9b057c63fad69cc3">01668</a> - (void)deminiaturize:(<span class="keywordtype">id</span>)sender
<a name="l01669"></a>01669 {
<a name="l01670"></a>01670     [[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a0aefd4e1b2119ed015fcf990b3f167b5">platformWindow</a>] <a class="code" href="class_c_p_platform_window.html#ad0619409513f515a8aba8703bc281064">deminiaturize</a>:sender];
<a name="l01671"></a>01671 
<a name="l01672"></a>01672     [[<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowDidDeminiaturizeNotification <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l01673"></a>01673 
<a name="l01674"></a>01674     _isMiniaturized = NO;
<a name="l01675"></a>01675 }
<a name="l01676"></a>01676 
<a name="l01680"></a><a class="code" href="class_c_p_window.html#ad14fec377e2d30492aa54f4a685d6024">01680</a> - (void)isMiniaturized
<a name="l01681"></a>01681 {
<a name="l01682"></a>01682     <span class="keywordflow">return</span> _isMiniaturized;
<a name="l01683"></a>01683 }
<a name="l01684"></a>01684 
<a name="l01685"></a>01685 <span class="comment">// Closing Windows</span>
<a name="l01686"></a>01686 
<a name="l01691"></a><a class="code" href="class_c_p_window.html#a893de03e20eff8154ceb2796457ee62e">01691</a> - (void)performClose:(<span class="keywordtype">id</span>)aSender
<a name="l01692"></a>01692 {
<a name="l01693"></a>01693     <span class="keywordflow">if</span> (!(_styleMask &amp; <a class="code" href="_c_p_window_8j.html#a023fc2836418fce3604d586d875d2506">CPClosableWindowMask</a>))
<a name="l01694"></a>01694         <span class="keywordflow">return</span>;
<a name="l01695"></a>01695 
<a name="l01696"></a>01696     <span class="keywordflow">if</span> ([<span class="keyword">self</span> isFullBridge])
<a name="l01697"></a>01697     {
<a name="l01698"></a>01698         var <span class="keyword">event</span> = [CPApp currentEvent];
<a name="l01699"></a>01699 
<a name="l01700"></a>01700         <span class="keywordflow">if</span> ([event type] === <a class="code" href="_c_p_event_8j.html#a44b7200967c244a014e1ee34ad02ecd9">CPKeyDown</a> &amp;&amp; [event characters] === <span class="stringliteral">&quot;w&quot;</span> &amp;&amp; ([event modifierFlags] &amp; CPPlatformActionKeyMask))
<a name="l01701"></a>01701         {
<a name="l01702"></a>01702             [[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a0aefd4e1b2119ed015fcf990b3f167b5">platformWindow</a>] _propagateCurrentDOMEvent:YES];
<a name="l01703"></a>01703             <span class="keywordflow">return</span>;
<a name="l01704"></a>01704         }
<a name="l01705"></a>01705     }
<a name="l01706"></a>01706 
<a name="l01707"></a>01707     <span class="comment">// Only send ONE windowShouldClose: message.</span>
<a name="l01708"></a>01708     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowShouldClose:)])
<a name="l01709"></a>01709     {
<a name="l01710"></a>01710         <span class="keywordflow">if</span> (![_delegate windowShouldClose:<span class="keyword">self</span>])
<a name="l01711"></a>01711             <span class="keywordflow">return</span>;
<a name="l01712"></a>01712     }
<a name="l01713"></a>01713     
<a name="l01714"></a>01714     <span class="comment">// Only check self is delegate does NOT implement this.  This also ensures this when delegate == self (returns true).</span>
<a name="l01715"></a>01715     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ([<span class="keyword">self</span> respondsToSelector:<span class="keyword">@selector</span>(windowShouldClose:)] &amp;&amp; ![<span class="keyword">self</span> windowShouldClose:<span class="keyword">self</span>])
<a name="l01716"></a>01716         <span class="keywordflow">return</span>;
<a name="l01717"></a>01717 
<a name="l01718"></a>01718     var documents = [_windowController documents];
<a name="l01719"></a>01719     <span class="keywordflow">if</span> ([documents count])
<a name="l01720"></a>01720     {
<a name="l01721"></a>01721         var index = [documents indexOfObject:[_windowController document]];
<a name="l01722"></a>01722 
<a name="l01723"></a>01723         [documents[index] shouldCloseWindowController:_windowController 
<a name="l01724"></a>01724                                              delegate:self 
<a name="l01725"></a>01725                                   shouldCloseSelector:@selector(_windowControllerContainingDocument:shouldClose:contextInfo:)
<a name="l01726"></a>01726                                           contextInfo:{documents:[documents copy], visited:0, index:index}];
<a name="l01727"></a>01727     }
<a name="l01728"></a>01728     <span class="keywordflow">else</span>
<a name="l01729"></a>01729         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab1263a85dda8bbaa7e3aab8791305fa0">close</a>];
<a name="l01730"></a>01730 }
<a name="l01731"></a>01731 
<a name="l01732"></a>01732 - (void)_windowControllerContainingDocument:(<a class="code" href="class_c_p_document.html">CPDocument</a>)document shouldClose:(BOOL)shouldClose contextInfo:(Object)context
<a name="l01733"></a>01733 {
<a name="l01734"></a>01734     <span class="keywordflow">if</span> (shouldClose)
<a name="l01735"></a>01735     {
<a name="l01736"></a>01736         var windowController = [<span class="keyword">self</span> windowController],
<a name="l01737"></a>01737             documents = context.documents,
<a name="l01738"></a>01738             count = [documents count],
<a name="l01739"></a>01739             visited = ++context.visited,
<a name="l01740"></a>01740             index = ++context.index % count;
<a name="l01741"></a>01741 
<a name="l01742"></a>01742         [document <a class="code" href="class_c_p_document.html#abd67bb1437829c88d647ac00f4213e31">removeWindowController</a>:windowController];
<a name="l01743"></a>01743 
<a name="l01744"></a>01744         <span class="keywordflow">if</span> (visited &lt; count)
<a name="l01745"></a>01745         {
<a name="l01746"></a>01746             [windowController setDocument:documents[index]];
<a name="l01747"></a>01747 
<a name="l01748"></a>01748             [documents[index] shouldCloseWindowController:_windowController 
<a name="l01749"></a>01749                                                  delegate:self 
<a name="l01750"></a>01750                                       shouldCloseSelector:@selector(_windowControllerContainingDocument:shouldClose:contextInfo:)
<a name="l01751"></a>01751                                               contextInfo:context];
<a name="l01752"></a>01752         }
<a name="l01753"></a>01753         <span class="keywordflow">else</span>
<a name="l01754"></a>01754             [<span class="keyword">self</span> close];
<a name="l01755"></a>01755     }
<a name="l01756"></a>01756 }
<a name="l01757"></a>01757 
<a name="l01762"></a><a class="code" href="class_c_p_window.html#ab1263a85dda8bbaa7e3aab8791305fa0">01762</a> - (void)close
<a name="l01763"></a>01763 {
<a name="l01764"></a>01764     [[<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowWillCloseNotification <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l01765"></a>01765 
<a name="l01766"></a>01766     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a7499cfb057ea3359b4d3bc3652efefaf">orderOut</a>:nil];
<a name="l01767"></a>01767 }
<a name="l01768"></a>01768 
<a name="l01769"></a>01769 <span class="comment">// Managing Main Status</span>
<a name="l01773"></a><a class="code" href="class_c_p_window.html#a5508c4d93c4a7d93f28c2aa6ad486814">01773</a> <span class="comment"></span>- (BOOL)isMainWindow
<a name="l01774"></a>01774 {
<a name="l01775"></a>01775     <span class="keywordflow">return</span> [CPApp mainWindow] == <span class="keyword">self</span>;
<a name="l01776"></a>01776 }
<a name="l01777"></a>01777 
<a name="l01781"></a><a class="code" href="class_c_p_window.html#ae19a9564994febb5c6c53331e773f8cf">01781</a> - (BOOL)canBecomeMainWindow
<a name="l01782"></a>01782 {
<a name="l01783"></a>01783     <span class="comment">// FIXME: Also check if we can resize and titlebar.</span>
<a name="l01784"></a>01784     <span class="keywordflow">if</span> ([<span class="keyword">self</span> isVisible])
<a name="l01785"></a>01785         <span class="keywordflow">return</span> YES;
<a name="l01786"></a>01786         
<a name="l01787"></a>01787     <span class="keywordflow">return</span> NO;
<a name="l01788"></a>01788 }
<a name="l01789"></a>01789 
<a name="l01793"></a><a class="code" href="class_c_p_window.html#a9ee2b9bd46241094df06934173c19d48">01793</a> - (void)makeMainWindow
<a name="l01794"></a>01794 {
<a name="l01795"></a>01795     <span class="keywordflow">if</span> (![<span class="keyword">self</span> canBecomeMainWindow])
<a name="l01796"></a>01796         <span class="keywordflow">return</span>;
<a name="l01797"></a>01797 
<a name="l01798"></a>01798     [CPApp._mainWindow resignMainWindow];
<a name="l01799"></a>01799     
<a name="l01800"></a>01800     <a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a>._mainWindow = <span class="keyword">self</span>;
<a name="l01801"></a>01801     
<a name="l01802"></a>01802     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a2a2e63fb79b44e28d6c194f8b0050cda">becomeMainWindow</a>];
<a name="l01803"></a>01803 }
<a name="l01804"></a>01804 
<a name="l01808"></a><a class="code" href="class_c_p_window.html#a2a2e63fb79b44e28d6c194f8b0050cda">01808</a> - (void)becomeMainWindow
<a name="l01809"></a>01809 {
<a name="l01810"></a>01810     [<span class="keyword">self</span> _synchronizeMenuBarTitleWithWindowTitle];
<a name="l01811"></a>01811     [<span class="keyword">self</span> _synchronizeSaveMenuWithDocumentSaving];
<a name="l01812"></a>01812     
<a name="l01813"></a>01813     [[<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>]
<a name="l01814"></a>01814         <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowDidBecomeMainNotification
<a name="l01815"></a>01815                       <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l01816"></a>01816 }
<a name="l01817"></a>01817 
<a name="l01821"></a><a class="code" href="class_c_p_window.html#a596c9cf6406c5dd1f7cf08ac770c58ae">01821</a> - (void)resignMainWindow
<a name="l01822"></a>01822 {
<a name="l01823"></a>01823     [[<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>]
<a name="l01824"></a>01824         <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowDidResignMainNotification
<a name="l01825"></a>01825                       <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l01826"></a>01826 }
<a name="l01827"></a>01827 
<a name="l01828"></a>01828 <span class="comment">// Managing Toolbars</span>
<a name="l01832"></a><a class="code" href="class_c_p_window.html#a9a4dceb293e1a80ec549859ac16090b0">01832</a> <span class="comment"></span>- (<a class="code" href="class_c_p_toolbar.html">CPToolbar</a>)toolbar
<a name="l01833"></a>01833 {
<a name="l01834"></a>01834     <span class="keywordflow">return</span> _toolbar;
<a name="l01835"></a>01835 }
<a name="l01836"></a>01836 
<a name="l01841"></a><a class="code" href="class_c_p_window.html#a3db9a0bcce7408d1e0fea4bf9c930a9f">01841</a> - (void)setToolbar:(<a class="code" href="class_c_p_toolbar.html">CPToolbar</a>)aToolbar
<a name="l01842"></a>01842 {
<a name="l01843"></a>01843     <span class="keywordflow">if</span> (_toolbar === aToolbar)
<a name="l01844"></a>01844         <span class="keywordflow">return</span>;
<a name="l01845"></a>01845     
<a name="l01846"></a>01846     <span class="comment">// If this has an owner, dump it!</span>
<a name="l01847"></a>01847     [[aToolbar _window] setToolbar:nil];
<a name="l01848"></a>01848     
<a name="l01849"></a>01849     <span class="comment">// This is no longer out toolbar.</span>
<a name="l01850"></a>01850     [_toolbar _setWindow:nil];
<a name="l01851"></a>01851     
<a name="l01852"></a>01852     _toolbar = aToolbar;
<a name="l01853"></a>01853     
<a name="l01854"></a>01854     <span class="comment">// THIS is our toolbar.</span>
<a name="l01855"></a>01855     [_toolbar _setWindow:self];
<a name="l01856"></a>01856     
<a name="l01857"></a>01857     [<span class="keyword">self</span> _noteToolbarChanged];
<a name="l01858"></a>01858 }
<a name="l01859"></a>01859 
<a name="l01860"></a><a class="code" href="class_c_p_window.html#a99692a4fb9610282a1e81dd6bb97d227">01860</a> - (void)toggleToolbarShown:(<span class="keywordtype">id</span>)aSender
<a name="l01861"></a>01861 {
<a name="l01862"></a>01862     var toolbar = [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a9a4dceb293e1a80ec549859ac16090b0">toolbar</a>];
<a name="l01863"></a>01863     
<a name="l01864"></a>01864     [<a class="code" href="class_c_p_window.html#a9a4dceb293e1a80ec549859ac16090b0">toolbar</a> <a class="code" href="class_c_p_toolbar.html#ae67aa421e6a79f8eaf0e008fe7dbbeb2">setVisible</a>:![<a class="code" href="class_c_p_window.html#a9a4dceb293e1a80ec549859ac16090b0">toolbar</a> <a class="code" href="class_c_p_toolbar.html#a4f3e1d69eb45cc1335cf3bca6f779368">isVisible</a>]];
<a name="l01865"></a>01865 }
<a name="l01866"></a>01866 
<a name="l01867"></a>01867 - (void)_noteToolbarChanged
<a name="l01868"></a>01868 {
<a name="l01869"></a>01869     var <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a> = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>([<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]),
<a name="l01870"></a>01870         newFrame;
<a name="l01871"></a>01871 
<a name="l01872"></a>01872     [_windowView noteToolbarChanged];
<a name="l01873"></a>01873 
<a name="l01874"></a>01874     <span class="keywordflow">if</span> (_isFullPlatformWindow)
<a name="l01875"></a>01875         newFrame = [_platformWindow visibleFrame];
<a name="l01876"></a>01876     <span class="keywordflow">else</span>
<a name="l01877"></a>01877     {
<a name="l01878"></a>01878         newFrame = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>([<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]);
<a name="l01879"></a>01879         
<a name="l01880"></a>01880         newFrame.origin = <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>.origin;
<a name="l01881"></a>01881     }
<a name="l01882"></a>01882     
<a name="l01883"></a>01883     [<span class="keyword">self</span> setFrame:newFrame];
<a name="l01884"></a>01884     <span class="comment">/*</span>
<a name="l01885"></a>01885 <span class="comment">    [_windowView setAnimatingToolbar:YES];</span>
<a name="l01886"></a>01886 <span class="comment">    [self setFrame:frame];</span>
<a name="l01887"></a>01887 <span class="comment">    [self setFrame:newFrame display:YES animate:YES];</span>
<a name="l01888"></a>01888 <span class="comment">    [_windowView setAnimatingToolbar:NO];</span>
<a name="l01889"></a>01889 <span class="comment">    */</span>
<a name="l01890"></a>01890 }
<a name="l01891"></a>01891 
<a name="l01892"></a>01892 - (void)_setFrame:(CGRect)aFrame delegate:(<span class="keywordtype">id</span>)delegate duration:(<span class="keywordtype">int</span>)duration curve:(CPAnimationCurve)curve
<a name="l01893"></a>01893 {
<a name="l01894"></a>01894     var animation = [[_CPWindowFrameAnimation alloc] initWithWindow:self targetFrame:aFrame];
<a name="l01895"></a>01895     [animation setDelegate:delegate];
<a name="l01896"></a>01896     [animation setAnimationCurve:curve];
<a name="l01897"></a>01897     [animation setDuration:duration];
<a name="l01898"></a>01898     [animation startAnimation];
<a name="l01899"></a>01899 }
<a name="l01900"></a>01900 
<a name="l01901"></a>01901 <span class="comment">/* @ignore */</span>
<a name="l01902"></a>01902 - (void)_setAttachedSheetFrameOrigin
<a name="l01903"></a>01903 {
<a name="l01904"></a>01904     <span class="comment">// Position the sheet above the contentRect.</span>
<a name="l01905"></a>01905     var attachedSheet = [<span class="keyword">self</span> attachedSheet];
<a name="l01906"></a>01906     var contentRect = [[<span class="keyword">self</span> contentView] frame],
<a name="l01907"></a>01907         sheetFrame = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>([attachedSheet <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]);
<a name="l01908"></a>01908         
<a name="l01909"></a>01909     sheetFrame.origin.y = <a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(_frame) + <a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(contentRect);
<a name="l01910"></a>01910     sheetFrame.origin.x = <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(_frame) + FLOOR((<a class="code" href="_c_g_geometry_8j.html#aa310af239f2108c573299b35776996fa">CGRectGetWidth</a>(_frame) - <a class="code" href="_c_g_geometry_8j.html#aa310af239f2108c573299b35776996fa">CGRectGetWidth</a>(sheetFrame)) / 2.0);
<a name="l01911"></a>01911    
<a name="l01912"></a>01912     [attachedSheet setFrameOrigin:sheetFrame.origin];
<a name="l01913"></a>01913 }
<a name="l01914"></a>01914 
<a name="l01915"></a>01915 <span class="comment">/* @ignore */</span>
<a name="l01916"></a>01916 - (void)_attachSheet:(<a class="code" href="class_c_p_window.html">CPWindow</a>)aSheet modalDelegate:(<span class="keywordtype">id</span>)aModalDelegate didEndSelector:(<span class="keywordtype">SEL</span>)aDidEndSelector contextInfo:(<span class="keywordtype">id</span>)aContextInfo
<a name="l01917"></a>01917 {
<a name="l01918"></a>01918     var sheetFrame = [aSheet <a class="code" href="class_c_p_window.html#a0eddef926f318eecaf793e702be6d5a5">frame</a>];
<a name="l01919"></a>01919 
<a name="l01920"></a>01920     _sheetContext = {<span class="stringliteral">&quot;sheet&quot;</span>:aSheet, <span class="stringliteral">&quot;modalDelegate&quot;</span>:aModalDelegate, <span class="stringliteral">&quot;endSelector&quot;</span>:aDidEndSelector, <span class="stringliteral">&quot;contextInfo&quot;</span>:aContextInfo, <span class="stringliteral">&quot;frame&quot;</span>:<a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>(sheetFrame), <span class="stringliteral">&quot;returnCode&quot;</span>:-1, &quot;opened&quot;: NO}; 
<a name="l01921"></a>01921     
<a name="l01922"></a>01922     [<span class="keyword">self</span> _attachSheetWindow:aSheet];
<a name="l01923"></a>01923 }
<a name="l01924"></a>01924 
<a name="l01925"></a>01925 <span class="comment">/* @ignore */</span>
<a name="l01926"></a>01926 - (void)_attachSheetWindow:(<a class="code" href="class_c_p_window.html">CPWindow</a>)aSheet
<a name="l01927"></a>01927 {
<a name="l01928"></a>01928     var sheetFrame = [aSheet <a class="code" href="class_c_p_window.html#a0eddef926f318eecaf793e702be6d5a5">frame</a>],
<a name="l01929"></a>01929         <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a> = [<span class="keyword">self</span> frame],
<a name="l01930"></a>01930         sheetContent = [aSheet <a class="code" href="class_c_p_window.html#ae8ea24657fb8bfaf38cba633ce8d4a21">contentView</a>];
<a name="l01931"></a>01931     
<a name="l01932"></a>01932     [<span class="keyword">self</span> _setUpMasksForView:sheetContent];
<a name="l01933"></a>01933          
<a name="l01934"></a>01934     aSheet._isSheet = YES;
<a name="l01935"></a>01935     aSheet._parentView = <span class="keyword">self</span>;
<a name="l01936"></a>01936     
<a name="l01937"></a>01937     var originx = <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>.origin.x + FLOOR((<a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>.<a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.<a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a> - sheetFrame.<a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.<a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a>)/2),
<a name="l01938"></a>01938         originy = <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>.origin.y + [[self contentView] <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>].origin.y,
<a name="l01939"></a>01939         startFrame = <a class="code" href="_c_g_geometry_8j.html#aca150c0049e24797c6271bad7bc90610">CGRectMake</a>(originx, originy, sheetFrame.<a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.<a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a>, 0),
<a name="l01940"></a>01940         endFrame = <a class="code" href="_c_g_geometry_8j.html#aca150c0049e24797c6271bad7bc90610">CGRectMake</a>(originx, originy, sheetFrame.<a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.<a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a>, sheetFrame.<a class="code" href="_c_p_screen_8j.html#ad241596b0d0f8cbdd1529d94ea71337b">size</a>.<a class="code" href="_c_p_screen_8j.html#a4540395d130d8a367becfe06b659b9f1">height</a>);
<a name="l01941"></a>01941 
<a name="l01942"></a>01942     [[<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowWillBeginSheetNotification <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l01943"></a>01943     [CPApp runModalForWindow:aSheet];
<a name="l01944"></a>01944     
<a name="l01945"></a>01945     [aSheet <a class="code" href="class_c_p_window.html#a4c3bebfd3f9b356fe3528f8697e95b0a">orderFront</a>:self];
<a name="l01946"></a>01946     [aSheet <a class="code" href="class_c_p_window.html#a7e55ac7c5a17669d408e497b4ae7d651">setFrame</a>:startFrame];
<a name="l01947"></a>01947     _sheetContext[&quot;opened&quot;] = YES;
<a name="l01948"></a>01948 
<a name="l01949"></a>01949     [aSheet _setFrame:endFrame delegate:self duration:0.2 curve:CPAnimationEaseOut];
<a name="l01950"></a>01950 
<a name="l01951"></a>01951     <span class="comment">// Should run the main loop here until _isAnimating = FALSE</span>
<a name="l01952"></a>01952     [aSheet <a class="code" href="class_c_p_window.html#a3cab8fa3cb78d27fbb996b460056a886">becomeKeyWindow</a>];    
<a name="l01953"></a>01953 }
<a name="l01954"></a>01954 
<a name="l01955"></a>01955 <span class="comment">/* @ignore */</span>
<a name="l01956"></a>01956 - (void)_detachSheetWindow
<a name="l01957"></a>01957 {
<a name="l01958"></a>01958     var sheet = [<span class="keyword">self</span> attachedSheet],
<a name="l01959"></a>01959         startFrame = [sheet frame],
<a name="l01960"></a>01960         endFrame = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>(startFrame);
<a name="l01961"></a>01961 
<a name="l01962"></a>01962     endFrame.size.height = 0;
<a name="l01963"></a>01963     
<a name="l01964"></a>01964     _sheetContext[&quot;frame&quot;] = startFrame;
<a name="l01965"></a>01965      
<a name="l01966"></a>01966     var sheetContent = [sheet contentView];
<a name="l01967"></a>01967     [<span class="keyword">self</span> _setUpMasksForView:sheetContent];
<a name="l01968"></a>01968 
<a name="l01969"></a>01969     _sheetContext[&quot;opened&quot;] = NO;
<a name="l01970"></a>01970     [sheet _setFrame:endFrame delegate:self duration:0.2 curve:CPAnimationEaseIn];
<a name="l01971"></a>01971 }
<a name="l01972"></a>01972 
<a name="l01973"></a>01973 <span class="comment">/* @ignore */</span>
<a name="l01974"></a><a class="code" href="class_c_p_window.html#aca0104e52e3be6f623a933759685bfd4">01974</a> - (void)animationDidEnd:(<span class="keywordtype">id</span>)anim
<a name="l01975"></a>01975 {
<a name="l01976"></a>01976     var sheet = _sheetContext[&quot;sheet&quot;];
<a name="l01977"></a>01977     <span class="keywordflow">if</span> (anim._window != sheet)
<a name="l01978"></a>01978         <span class="keywordflow">return</span>;
<a name="l01979"></a>01979 
<a name="l01980"></a>01980     var sheetContent = [sheet contentView];
<a name="l01981"></a>01981     
<a name="l01982"></a>01982     <span class="keywordflow">if</span> (_sheetContext[<span class="stringliteral">&quot;opened&quot;</span>] === YES)
<a name="l01983"></a>01983     {
<a name="l01984"></a>01984         [<span class="keyword">self</span> _restoreMasksForView:sheetContent];
<a name="l01985"></a>01985         <span class="keywordflow">return</span>;
<a name="l01986"></a>01986     }
<a name="l01987"></a>01987     
<a name="l01988"></a>01988     [CPApp stopModal];    
<a name="l01989"></a>01989     [[<a class="code" href="class_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowDidEndSheetNotification <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l01990"></a>01990 
<a name="l01991"></a>01991     [sheet orderOut:self];
<a name="l01992"></a>01992 
<a name="l01993"></a>01993     var lastFrame = _sheetContext[&quot;frame&quot;];
<a name="l01994"></a>01994     [sheet setFrame:lastFrame];
<a name="l01995"></a>01995     
<a name="l01996"></a>01996     [<span class="keyword">self</span> _restoreMasksForView:sheetContent];
<a name="l01997"></a>01997 
<a name="l01998"></a>01998     var delegate = _sheetContext[&quot;modalDelegate&quot;],
<a name="l01999"></a>01999         endSelector = _sheetContext[&quot;endSelector&quot;];
<a name="l02000"></a>02000 
<a name="l02001"></a>02001     <span class="keywordflow">if</span> (delegate != nil &amp;&amp; endSelector != nil)   
<a name="l02002"></a>02002         objj_msgSend(delegate, endSelector, sheet, _sheetContext[<span class="stringliteral">&quot;returnCode&quot;</span>], _sheetContext[<span class="stringliteral">&quot;contextInfo&quot;</span>]);
<a name="l02003"></a>02003 
<a name="l02004"></a>02004     _sheetContext = nil;
<a name="l02005"></a>02005     sheet._parentView = nil;
<a name="l02006"></a>02006 }
<a name="l02007"></a>02007 
<a name="l02008"></a>02008 - (void)_setUpMasksForView:(<a class="code" href="class_c_p_view.html">CPView</a>)aView
<a name="l02009"></a>02009 {
<a name="l02010"></a>02010     var views = [aView <a class="code" href="class_c_p_view.html#ad1d0643685491bf8e809d320fb7d6046">subviews</a>];
<a name="l02011"></a>02011 
<a name="l02012"></a>02012     [views addObject:aView];
<a name="l02013"></a>02013     
<a name="l02014"></a>02014     <span class="keywordflow">for</span> (var i = 0, count = [views count]; i &lt; count; i++)
<a name="l02015"></a>02015     {
<a name="l02016"></a>02016         var view = [views objectAtIndex:i],
<a name="l02017"></a>02017             mask = [view autoresizingMask],
<a name="l02018"></a>02018             maskToAdd = (mask &amp; <a class="code" href="_c_p_view_8j.html#ae53e9a5baa124727e5c6b7f1f22abf33">CPViewMinYMargin</a>) ? 128 : <a class="code" href="_c_p_view_8j.html#ae53e9a5baa124727e5c6b7f1f22abf33">CPViewMinYMargin</a>;
<a name="l02019"></a>02019 
<a name="l02020"></a>02020         [view setAutoresizingMask:(mask | maskToAdd)];
<a name="l02021"></a>02021     }
<a name="l02022"></a>02022 }
<a name="l02023"></a>02023 
<a name="l02024"></a>02024 - (void)_restoreMasksForView:(<a class="code" href="class_c_p_view.html">CPView</a>)aView
<a name="l02025"></a>02025 {
<a name="l02026"></a>02026     var views = [aView <a class="code" href="class_c_p_view.html#ad1d0643685491bf8e809d320fb7d6046">subviews</a>];
<a name="l02027"></a>02027 
<a name="l02028"></a>02028     [views addObject:aView];
<a name="l02029"></a>02029     
<a name="l02030"></a>02030     <span class="keywordflow">for</span> (var i = 0, count = [views count]; i &lt; count; i++)
<a name="l02031"></a>02031     {
<a name="l02032"></a>02032         var view = [views objectAtIndex:i],
<a name="l02033"></a>02033             mask = [view autoresizingMask],
<a name="l02034"></a>02034             maskToRemove = (mask &amp; 128) ? 128 : <a class="code" href="_c_p_view_8j.html#ae53e9a5baa124727e5c6b7f1f22abf33">CPViewMinYMargin</a>;
<a name="l02035"></a>02035 
<a name="l02036"></a>02036         [view setAutoresizingMask:(mask &amp; (~ maskToRemove))];
<a name="l02037"></a>02037     }
<a name="l02038"></a>02038 }
<a name="l02039"></a>02039 
<a name="l02043"></a><a class="code" href="class_c_p_window.html#ae5aa7ed31b068622d790c6997f40d30e">02043</a> - (<a class="code" href="class_c_p_window.html">CPWindow</a>)attachedSheet
<a name="l02044"></a>02044 {
<a name="l02045"></a>02045     <span class="keywordflow">if</span> (_sheetContext === nil)
<a name="l02046"></a>02046         <span class="keywordflow">return</span> nil;
<a name="l02047"></a>02047         
<a name="l02048"></a>02048    <span class="keywordflow">return</span> _sheetContext[&quot;sheet&quot;];
<a name="l02049"></a>02049 }
<a name="l02050"></a>02050 
<a name="l02054"></a><a class="code" href="class_c_p_window.html#a64d5d40a8db00592ea6e625295e2d84d">02054</a> - (BOOL)isSheet
<a name="l02055"></a>02055 {
<a name="l02056"></a>02056     <span class="keywordflow">return</span> _isSheet;
<a name="l02057"></a>02057 }
<a name="l02058"></a>02058 
<a name="l02059"></a>02059 <span class="comment">//</span>
<a name="l02060"></a>02060 <span class="comment">/*</span>
<a name="l02061"></a>02061 <span class="comment">    Used privately.</span>
<a name="l02062"></a>02062 <span class="comment">    @ignore</span>
<a name="l02063"></a>02063 <span class="comment">*/</span>
<a name="l02064"></a><a class="code" href="class_c_p_window.html#aa627e57a4b76b9b6f74c7fa9ff299d40">02064</a> - (BOOL)becomesKeyOnlyIfNeeded
<a name="l02065"></a>02065 {
<a name="l02066"></a>02066     <span class="keywordflow">return</span> NO;
<a name="l02067"></a>02067 }
<a name="l02068"></a>02068 
<a name="l02073"></a><a class="code" href="class_c_p_window.html#a9bf8bd32818c6a78abf357ff524524ef">02073</a> - (BOOL)worksWhenModal
<a name="l02074"></a>02074 {
<a name="l02075"></a>02075     <span class="keywordflow">return</span> NO;
<a name="l02076"></a>02076 }
<a name="l02077"></a>02077 
<a name="l02078"></a><a class="code" href="class_c_p_window.html#ab8497e025ddc38f6b37b73f7ace97284">02078</a> - (void)performKeyEquivalent:(<a class="code" href="class_c_p_event.html">CPEvent</a>)anEvent
<a name="l02079"></a>02079 {
<a name="l02080"></a>02080     <span class="comment">// FIXME: should we be starting at the root, in other words _windowView?</span>
<a name="l02081"></a>02081     <span class="comment">// The evidence seems to point to no...</span>
<a name="l02082"></a>02082     <span class="keywordflow">return</span> [[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ae8ea24657fb8bfaf38cba633ce8d4a21">contentView</a>] <a class="code" href="class_c_p_view.html#abbb86d5e6953fc8c01592a48835925cc">performKeyEquivalent</a>:anEvent];
<a name="l02083"></a>02083 }
<a name="l02084"></a>02084 
<a name="l02085"></a><a class="code" href="class_c_p_window.html#aac2174cecd8487bd2c7c5a9de1e9345d">02085</a> - (void)keyDown:(<a class="code" href="class_c_p_event.html">CPEvent</a>)anEvent
<a name="l02086"></a>02086 {
<a name="l02087"></a>02087     <span class="comment">// It&#39;s not clear why we do performKeyEquivalent again here...</span>
<a name="l02088"></a>02088     <span class="comment">// Perhaps to allow something to happen between sendEvent: and keyDown:?</span>
<a name="l02089"></a>02089     <span class="keywordflow">if</span> (![anEvent _couldBeKeyEquivalent] || ![<span class="keyword">self</span> performKeyEquivalent:anEvent])
<a name="l02090"></a>02090         [<span class="keyword">self</span> interpretKeyEvents:[anEvent]];
<a name="l02091"></a>02091 }
<a name="l02092"></a>02092 
<a name="l02093"></a><a class="code" href="class_c_p_window.html#a31a0adf63f2c3f1555db40f19f6e0b1e">02093</a> - (void)insertNewline:(<span class="keywordtype">id</span>)sender
<a name="l02094"></a>02094 {
<a name="l02095"></a>02095     <span class="keywordflow">if</span> (_defaultButton &amp;&amp; _defaultButtonEnabled)
<a name="l02096"></a>02096         [_defaultButton performClick:nil];
<a name="l02097"></a>02097 }
<a name="l02098"></a>02098 
<a name="l02099"></a><a class="code" href="class_c_p_window.html#a7d2bcddeba1a632968ce1ba8b86e510f">02099</a> - (void)insertTab:(<span class="keywordtype">id</span>)sender
<a name="l02100"></a>02100 {
<a name="l02101"></a>02101     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a50be45492f5a15060f3f358dc7157d67">selectNextKeyView</a>:nil];
<a name="l02102"></a>02102 }
<a name="l02103"></a>02103 
<a name="l02104"></a>02104 - (void)_dirtyKeyViewLoop
<a name="l02105"></a>02105 {
<a name="l02106"></a>02106     <span class="keywordflow">if</span> (_autorecalculatesKeyViewLoop)
<a name="l02107"></a>02107         _keyViewLoopIsDirty = YES;
<a name="l02108"></a>02108 }
<a name="l02109"></a>02109 
<a name="l02110"></a>02110 - (BOOL)_hasKeyViewLoop
<a name="l02111"></a>02111 {
<a name="l02112"></a>02112     var subviews = [];
<a name="l02113"></a>02113 
<a name="l02114"></a>02114     [<span class="keyword">self</span> _appendSubviewsOf:_contentView toArray:subviews];
<a name="l02115"></a>02115 
<a name="l02116"></a>02116     <span class="keywordflow">for</span> (var i = 0, count = [subviews count]; i&lt;count; i++)
<a name="l02117"></a>02117     {
<a name="l02118"></a>02118         <span class="keywordflow">if</span> (subviews[i]._nextKeyView)
<a name="l02119"></a>02119             <span class="keywordflow">return</span> YES;
<a name="l02120"></a>02120     }
<a name="l02121"></a>02121 
<a name="l02122"></a>02122     <span class="keywordflow">return</span> NO;
<a name="l02123"></a>02123 }
<a name="l02124"></a>02124 
<a name="l02125"></a><a class="code" href="class_c_p_window.html#ad7802cda45e07f710b5da50740f1fd18">02125</a> - (void)recalculateKeyViewLoop
<a name="l02126"></a>02126 {
<a name="l02127"></a>02127     var subviews = [];
<a name="l02128"></a>02128     
<a name="l02129"></a>02129     [<span class="keyword">self</span> _appendSubviewsOf:_contentView toArray:subviews];
<a name="l02130"></a>02130 
<a name="l02131"></a>02131     var keyViewOrder = [subviews sortedArrayUsingFunction:keyViewComparator context:_contentView],
<a name="l02132"></a>02132         count = [keyViewOrder count];
<a name="l02133"></a>02133 
<a name="l02134"></a>02134     <span class="keywordflow">for</span> (var i=0; i&lt;count; i++)
<a name="l02135"></a>02135         [keyViewOrder[i] setNextKeyView:keyViewOrder[(i+1)%count]];
<a name="l02136"></a>02136     
<a name="l02137"></a>02137     _keyViewLoopIsDirty = NO;
<a name="l02138"></a>02138 }
<a name="l02139"></a>02139 
<a name="l02140"></a>02140 - (void)_appendSubviewsOf:(<a class="code" href="class_c_p_view.html">CPView</a>)aView toArray:(<a class="code" href="class_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript...">CPArray</a>)anArray
<a name="l02141"></a>02141 {
<a name="l02142"></a>02142     var subviews = [aView <a class="code" href="class_c_p_view.html#ad1d0643685491bf8e809d320fb7d6046">subviews</a>],
<a name="l02143"></a>02143         count = [subviews count];
<a name="l02144"></a>02144 
<a name="l02145"></a>02145     <span class="keywordflow">while</span> (count--)
<a name="l02146"></a>02146         [<span class="keyword">self</span> _appendSubviewsOf:subviews[count] toArray:anArray];
<a name="l02147"></a>02147 
<a name="l02148"></a>02148     [anArray <a class="code" href="class_c_p_array.html#aa9b30d4c68c37973bb2c61ff2bb9ba15">addObject</a>:aView];
<a name="l02149"></a>02149 }
<a name="l02150"></a>02150 
<a name="l02151"></a><a class="code" href="class_c_p_window.html#a0a7107837b6dad0b1addf74764d23798">02151</a> - (void)setAutorecalculatesKeyViewLoop:(BOOL)shouldRecalculate
<a name="l02152"></a>02152 {
<a name="l02153"></a>02153     <span class="keywordflow">if</span> (_autorecalculatesKeyViewLoop === shouldRecalculate)
<a name="l02154"></a>02154         <span class="keywordflow">return</span>;
<a name="l02155"></a>02155 
<a name="l02156"></a>02156     _autorecalculatesKeyViewLoop = shouldRecalculate;
<a name="l02157"></a>02157     
<a name="l02158"></a>02158     <span class="keywordflow">if</span> (_keyViewLoopIsDirty)
<a name="l02159"></a>02159         [<span class="keyword">self</span> recalculateKeyViewLoop];
<a name="l02160"></a>02160     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_autorecalculatesKeyViewLoop)
<a name="l02161"></a>02161         [<span class="keyword">self</span> _dirtyKeyViewLoop];
<a name="l02162"></a>02162 }
<a name="l02163"></a>02163 
<a name="l02164"></a><a class="code" href="class_c_p_window.html#a7d859d712c44fb75bdae849ae60dd7a5">02164</a> - (BOOL)autorecalculatesKeyViewLoop
<a name="l02165"></a>02165 {
<a name="l02166"></a>02166     <span class="keywordflow">return</span> _autorecalculatesKeyViewLoop;
<a name="l02167"></a>02167 }
<a name="l02168"></a>02168 
<a name="l02169"></a><a class="code" href="class_c_p_window.html#a50be45492f5a15060f3f358dc7157d67">02169</a> - (void)selectNextKeyView:(<span class="keywordtype">id</span>)sender
<a name="l02170"></a>02170 {
<a name="l02171"></a>02171     <span class="keywordflow">if</span> ([_firstResponder isKindOfClass:[<a class="code" href="class_c_p_view.html">CPView</a> <span class="keyword">class</span>]])
<a name="l02172"></a>02172         [<span class="keyword">self</span> selectKeyViewFollowingView:_firstResponder];
<a name="l02173"></a>02173 }
<a name="l02174"></a>02174 
<a name="l02175"></a><a class="code" href="class_c_p_window.html#a66bd5f7c00770b588786586a7eb0a584">02175</a> - (void)selectPreviousKeyView:(<span class="keywordtype">id</span>)sender
<a name="l02176"></a>02176 {
<a name="l02177"></a>02177     <span class="keywordflow">if</span> ([_firstResponder isKindOfClass:[<a class="code" href="class_c_p_view.html">CPView</a> <span class="keyword">class</span>]])
<a name="l02178"></a>02178         [<span class="keyword">self</span> selectKeyViewPrecedingView:_firstResponder];
<a name="l02179"></a>02179 }
<a name="l02180"></a>02180 
<a name="l02181"></a><a class="code" href="class_c_p_window.html#a65ba5d5047d99f1ff3469985ed738aa1">02181</a> - (void)selectKeyViewFollowingView:(<a class="code" href="class_c_p_view.html">CPView</a>)aView
<a name="l02182"></a>02182 {
<a name="l02183"></a>02183     <span class="keywordflow">if</span> (_keyViewLoopIsDirty)
<a name="l02184"></a>02184         [<span class="keyword">self</span> recalculateKeyViewLoop];
<a name="l02185"></a>02185 
<a name="l02186"></a>02186     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#abaf02cdc9845e6ceb278b6fe6c4e0074">makeFirstResponder</a>:[aView <a class="code" href="class_c_p_view.html#a7b239de3414304837cedb99758362d83">nextValidKeyView</a>]];
<a name="l02187"></a>02187 }
<a name="l02188"></a>02188 
<a name="l02189"></a><a class="code" href="class_c_p_window.html#a98988c2a33e805855d55ccd056ee6620">02189</a> - (void)selectKeyViewPrecedingView:(<a class="code" href="class_c_p_view.html">CPView</a>)aView
<a name="l02190"></a>02190 {
<a name="l02191"></a>02191     <span class="keywordflow">if</span> (_keyViewLoopIsDirty)
<a name="l02192"></a>02192         [<span class="keyword">self</span> recalculateKeyViewLoop];
<a name="l02193"></a>02193 
<a name="l02194"></a>02194     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#abaf02cdc9845e6ceb278b6fe6c4e0074">makeFirstResponder</a>:[aView <a class="code" href="class_c_p_view.html#ab8562f5d69d29e8097c932f839e22319">previousValidKeyView</a>]];
<a name="l02195"></a>02195 }
<a name="l02196"></a>02196 
<a name="l02197"></a><a class="code" href="class_c_p_window.html#a8f2af7f1c2ff045e7bf352152f163f09">02197</a> - (void)setDefaultButtonCell:(<a class="code" href="class_c_p_button.html">CPButton</a>)aButton
<a name="l02198"></a>02198 {
<a name="l02199"></a>02199     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a5d095d0bf95ddc40fc8c029902a2aaf9">setDefaultButton</a>:aButton];
<a name="l02200"></a>02200 }
<a name="l02201"></a>02201 
<a name="l02202"></a><a class="code" href="class_c_p_window.html#a418ed4703d31e53905f56b5607dfcb8c">02202</a> - (<a class="code" href="class_c_p_button.html">CPButton</a>)defaultButtonCell
<a name="l02203"></a>02203 {
<a name="l02204"></a>02204     <span class="keywordflow">return</span> [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a80c03301a77d490f7eaa1ad12e9f3f6f">defaultButton</a>];
<a name="l02205"></a>02205 }
<a name="l02206"></a>02206 
<a name="l02207"></a><a class="code" href="class_c_p_window.html#a5d095d0bf95ddc40fc8c029902a2aaf9">02207</a> - (void)setDefaultButton:(<a class="code" href="class_c_p_button.html">CPButton</a>)aButton
<a name="l02208"></a>02208 {
<a name="l02209"></a>02209     [_defaultButton setDefaultButton:NO];
<a name="l02210"></a>02210 
<a name="l02211"></a>02211     _defaultButton = aButton;
<a name="l02212"></a>02212 
<a name="l02213"></a>02213     [_defaultButton setDefaultButton:YES];    
<a name="l02214"></a>02214 }
<a name="l02215"></a>02215 
<a name="l02216"></a><a class="code" href="class_c_p_window.html#a80c03301a77d490f7eaa1ad12e9f3f6f">02216</a> - (<a class="code" href="class_c_p_button.html">CPButton</a>)defaultButton
<a name="l02217"></a>02217 {
<a name="l02218"></a>02218     <span class="keywordflow">return</span> _defaultButton;
<a name="l02219"></a>02219 }
<a name="l02220"></a>02220 
<a name="l02221"></a><a class="code" href="class_c_p_window.html#ac6c418d46a934a74e22d04729b54d3e8">02221</a> - (void)enableKeyEquivalentForDefaultButton
<a name="l02222"></a>02222 {
<a name="l02223"></a>02223     _defaultButtonEnabled = YES;
<a name="l02224"></a>02224 }
<a name="l02225"></a>02225 
<a name="l02226"></a><a class="code" href="class_c_p_window.html#a97786474426316f8c88c79f68a3727b6">02226</a> - (void)enableKeyEquivalentForDefaultButtonCell
<a name="l02227"></a>02227 {
<a name="l02228"></a>02228     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ac6c418d46a934a74e22d04729b54d3e8">enableKeyEquivalentForDefaultButton</a>];
<a name="l02229"></a>02229 }
<a name="l02230"></a>02230 
<a name="l02231"></a><a class="code" href="class_c_p_window.html#ab8cc65b32e81ffed354fd872880dcc51">02231</a> - (void)disableKeyEquivalentForDefaultButton
<a name="l02232"></a>02232 {
<a name="l02233"></a>02233     _defaultButtonEnabled = NO;
<a name="l02234"></a>02234 }
<a name="l02235"></a>02235 
<a name="l02236"></a><a class="code" href="class_c_p_window.html#acdb0a1e6dc138a3b7b9f64cd22190edf">02236</a> - (void)disableKeyEquivalentForDefaultButtonCell
<a name="l02237"></a>02237 {
<a name="l02238"></a>02238     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab8cc65b32e81ffed354fd872880dcc51">disableKeyEquivalentForDefaultButton</a>];
<a name="l02239"></a>02239 }
<a name="l02240"></a>02240 
<a name="l02241"></a>02241 <span class="keyword">@end</span>
<a name="l02242"></a>02242 
<a name="l02243"></a><a class="code" href="_c_p_window_8j.html#a5b1c9bc5e6feaa814ed9a6a4106e7829">02243</a> var <a class="code" href="_c_p_window_8j.html#a5b1c9bc5e6feaa814ed9a6a4106e7829">keyViewComparator</a> = function(a, b, context)
<a name="l02244"></a>02244 {
<a name="l02245"></a>02245     var viewBounds = [a convertRect:[a bounds] toView:nil],
<a name="l02246"></a>02246         otherBounds = [b convertRect:[b bounds] toView:nil];
<a name="l02247"></a>02247 
<a name="l02248"></a>02248     <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(viewBounds) &lt; <a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(otherBounds))
<a name="l02249"></a>02249         <span class="keywordflow">return</span> -1;
<a name="l02250"></a>02250     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(viewBounds) == <a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(otherBounds) &amp;&amp; <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(viewBounds) &lt; <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(otherBounds))
<a name="l02251"></a>02251         <span class="keywordflow">return</span> -1;
<a name="l02252"></a>02252     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(viewBounds) == <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(otherBounds) &amp;&amp; <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(viewBounds) == <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(otherBounds))
<a name="l02253"></a>02253         <span class="keywordflow">return</span> 0;
<a name="l02254"></a>02254     <span class="keywordflow">else</span>
<a name="l02255"></a>02255         <span class="keywordflow">return</span> 1;
<a name="l02256"></a>02256 }
<a name="l02257"></a>02257 
<a name="l02258"></a>02258 <span class="keyword">@implementation </span><a class="code" href="class_c_p_window.html">CPWindow</a> (MenuBar)
<a name="l02259"></a>02259 
<a name="l02260"></a>02260 - (void)_synchronizeMenuBarTitleWithWindowTitle
<a name="l02261"></a>02261 {
<a name="l02262"></a>02262     <span class="comment">// Windows with Documents automatically update the native window title and the menu bar title.</span>
<a name="l02263"></a>02263     <span class="keywordflow">if</span> (![_windowController document] || ![<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a5508c4d93c4a7d93f28c2aa6ad486814">isMainWindow</a>])
<a name="l02264"></a>02264         <span class="keywordflow">return</span>;
<a name="l02265"></a>02265 
<a name="l02266"></a>02266     [<a class="code" href="class_c_p_menu.html">CPMenu</a> <a class="code" href="class_c_p_menu.html#a5c9673072cd4d8930741ea406397a974">setMenuBarTitle</a>:_title];
<a name="l02267"></a>02267 }
<a name="l02268"></a>02268 
<a name="l02269"></a>02269 <span class="keyword">@end</span>
<a name="l02270"></a>02270 
<a name="l02271"></a>02271 <span class="keyword">@implementation </span><a class="code" href="class_c_p_window.html">CPWindow</a> (BridgeSupport)
<a name="l02272"></a>02272 
<a name="l02273"></a>02273 <span class="comment">/*</span>
<a name="l02274"></a>02274 <span class="comment">    @ignore</span>
<a name="l02275"></a>02275 <span class="comment">*/</span>
<a name="l02276"></a>02276 - (void)resizeWithOldPlatformWindowSize:(CGSize)aSize
<a name="l02277"></a>02277 {
<a name="l02278"></a>02278     <span class="keywordflow">if</span> ([<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#af9c54355c1fb988869cab246aeb4376b">isFullPlatformWindow</a>])
<a name="l02279"></a>02279         <span class="keywordflow">return</span> [<span class="keyword">self</span> setFrame:[_platformWindow visibleFrame]];
<a name="l02280"></a>02280     
<a name="l02281"></a>02281     <span class="keywordflow">if</span> (_autoresizingMask == <a class="code" href="_c_p_window_8j.html#a556155bbdc19382299b5ef083560284b">CPWindowNotSizable</a>)
<a name="l02282"></a>02282         <span class="keywordflow">return</span>;
<a name="l02283"></a>02283 
<a name="l02284"></a>02284     var <a class="code" href="class_c_p_window.html#a0eddef926f318eecaf793e702be6d5a5">frame</a> = [_platformWindow contentBounds],
<a name="l02285"></a>02285         newFrame = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>(_frame),
<a name="l02286"></a>02286         dX = (<a class="code" href="_c_g_geometry_8j.html#aa310af239f2108c573299b35776996fa">CGRectGetWidth</a>(frame) - aSize.<a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a>) /
<a name="l02287"></a>02287             (((_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a9f8c18b9026cebcb2a1f8f91a01d5685">CPWindowMinXMargin</a>) ? 1 : 0) + (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a00f963c2ad31d2392edc1061592e1868">CPWindowWidthSizable</a> ? 1 : 0) + (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#aa334d7b21d635b43f2e0a3ed993c19dd">CPWindowMaxXMargin</a> ? 1 : 0)),
<a name="l02288"></a>02288         dY = (<a class="code" href="_c_g_geometry_8j.html#a09d2072d60c7f39b04a41705d640fa98">CGRectGetHeight</a>(frame) - aSize.height) /
<a name="l02289"></a>02289             ((_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a602a019923a512326b42022289ca5238">CPWindowMinYMargin</a> ? 1 : 0) + (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#ad1bc138bdcf0c5b9690c8b1508c49f43">CPWindowHeightSizable</a> ? 1 : 0) + (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a46ec4bd30fada9b12a2cc412b40e7f07">CPWindowMaxYMargin</a> ? 1 : 0));
<a name="l02290"></a>02290 
<a name="l02291"></a>02291     <span class="keywordflow">if</span> (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a9f8c18b9026cebcb2a1f8f91a01d5685">CPWindowMinXMargin</a>)
<a name="l02292"></a>02292         newFrame.origin.x += dX;
<a name="l02293"></a>02293     <span class="keywordflow">if</span> (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a00f963c2ad31d2392edc1061592e1868">CPWindowWidthSizable</a>)
<a name="l02294"></a>02294         newFrame.size.width += dX;
<a name="l02295"></a>02295     
<a name="l02296"></a>02296     <span class="keywordflow">if</span> (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a602a019923a512326b42022289ca5238">CPWindowMinYMargin</a>)
<a name="l02297"></a>02297         newFrame.origin.y += dY;
<a name="l02298"></a>02298     <span class="keywordflow">if</span> (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#ad1bc138bdcf0c5b9690c8b1508c49f43">CPWindowHeightSizable</a>)
<a name="l02299"></a>02299         newFrame.size.height += dY;
<a name="l02300"></a>02300 
<a name="l02301"></a>02301     [<span class="keyword">self</span> setFrame:newFrame];
<a name="l02302"></a>02302 }
<a name="l02303"></a>02303 
<a name="l02304"></a>02304 <span class="comment">/*</span>
<a name="l02305"></a>02305 <span class="comment">    @ignore</span>
<a name="l02306"></a>02306 <span class="comment">*/</span>
<a name="l02307"></a>02307 - (void)setAutoresizingMask:(<span class="keywordtype">unsigned</span>)anAutoresizingMask
<a name="l02308"></a>02308 {
<a name="l02309"></a>02309     _autoresizingMask = anAutoresizingMask;
<a name="l02310"></a>02310 }
<a name="l02311"></a>02311 
<a name="l02312"></a>02312 <span class="comment">/*</span>
<a name="l02313"></a>02313 <span class="comment">    @ignore</span>
<a name="l02314"></a>02314 <span class="comment">*/</span>
<a name="l02315"></a>02315 - (unsigned)autoresizingMask
<a name="l02316"></a>02316 {
<a name="l02317"></a>02317     <span class="keywordflow">return</span> _autoresizingMask;
<a name="l02318"></a>02318 }
<a name="l02319"></a>02319 
<a name="l02320"></a>02320 - (CGPoint)convertBaseToGlobal:(CGPoint)aPoint
<a name="l02321"></a>02321 {
<a name="l02322"></a>02322     <span class="keywordflow">return</span> [<a class="code" href="class_c_p_platform.html">CPPlatform</a> <a class="code" href="class_c_p_platform.html#add8d61d0f32ef6cac1102f1e1c70db78">isBrowser</a>] ? [<span class="keyword">self</span> convertBaseToPlatformWindow:aPoint] : [<span class="keyword">self</span> convertBaseToScreen:aPoint];
<a name="l02323"></a>02323 }
<a name="l02324"></a>02324 
<a name="l02325"></a>02325 - (CGPoint)convertGlobalToBase:(CGPoint)aPoint
<a name="l02326"></a>02326 {
<a name="l02327"></a>02327     <span class="keywordflow">return</span> [<a class="code" href="class_c_p_platform.html">CPPlatform</a> <a class="code" href="class_c_p_platform.html#add8d61d0f32ef6cac1102f1e1c70db78">isBrowser</a>] ? [<span class="keyword">self</span> convertPlatformWindowToBase:aPoint] : [<span class="keyword">self</span> convertScreenToBase:aPoint];
<a name="l02328"></a>02328 }
<a name="l02329"></a>02329 
<a name="l02330"></a>02330 - (CGPoint)convertBaseToPlatformWindow:(CGPoint)aPoint
<a name="l02331"></a>02331 {
<a name="l02332"></a>02332     <span class="keywordflow">if</span> ([<span class="keyword">self</span> _sharesChromeWithPlatformWindow])
<a name="l02333"></a>02333         <span class="keywordflow">return</span> aPoint;
<a name="l02334"></a>02334 
<a name="l02335"></a>02335     var origin = [<span class="keyword">self</span> frame].origin;
<a name="l02336"></a>02336 
<a name="l02337"></a>02337     <span class="keywordflow">return</span> _CGPointMake(aPoint.x + origin.x, aPoint.y + origin.y);
<a name="l02338"></a>02338 }
<a name="l02339"></a>02339 
<a name="l02340"></a>02340 - (CGPoint)convertPlatformWindowToBase:(CGPoint)aPoint
<a name="l02341"></a>02341 {
<a name="l02342"></a>02342     <span class="keywordflow">if</span> ([<span class="keyword">self</span> _sharesChromeWithPlatformWindow])
<a name="l02343"></a>02343         <span class="keywordflow">return</span> aPoint;
<a name="l02344"></a>02344 
<a name="l02345"></a>02345     var origin = [<span class="keyword">self</span> frame].origin;
<a name="l02346"></a>02346 
<a name="l02347"></a>02347     <span class="keywordflow">return</span> _CGPointMake(aPoint.x - origin.x, aPoint.y - origin.y);
<a name="l02348"></a>02348 }
<a name="l02349"></a>02349 
<a name="l02350"></a>02350 - (CGPoint)convertScreenToBase:(CGPoint)aPoint
<a name="l02351"></a>02351 {
<a name="l02352"></a>02352     <span class="keywordflow">return</span> [<span class="keyword">self</span> convertPlatformWindowToBase:[_platformWindow convertScreenToBase:aPoint]];
<a name="l02353"></a>02353 }
<a name="l02354"></a>02354 
<a name="l02355"></a>02355 - (CGPoint)convertBaseToScreen:(CGPoint)aPoint
<a name="l02356"></a>02356 {
<a name="l02357"></a>02357     <span class="keywordflow">return</span> [_platformWindow convertBaseToScreen:[<span class="keyword">self</span> convertBaseToPlatformWindow:aPoint]];
<a name="l02358"></a>02358 }
<a name="l02359"></a>02359 
<a name="l02360"></a>02360 - (void)_setSharesChromeWithPlatformWindow:(BOOL)shouldShareFrameWithPlatformWindow
<a name="l02361"></a>02361 {
<a name="l02362"></a>02362     <span class="comment">// We canna&#39; do it captain! We just don&#39;t have the power!</span>
<a name="l02363"></a>02363     <span class="keywordflow">if</span> (shouldShareFrameWithPlatformWindow &amp;&amp; [<a class="code" href="class_c_p_platform.html">CPPlatform</a> isBrowser])
<a name="l02364"></a>02364         <span class="keywordflow">return</span>;
<a name="l02365"></a>02365 
<a name="l02366"></a>02366     _sharesChromeWithPlatformWindow = shouldShareFrameWithPlatformWindow;
<a name="l02367"></a>02367 
<a name="l02368"></a>02368     [<span class="keyword">self</span> _updateShadow];
<a name="l02369"></a>02369 }
<a name="l02370"></a>02370 
<a name="l02371"></a>02371 - (BOOL)_sharesChromeWithPlatformWindow
<a name="l02372"></a>02372 {
<a name="l02373"></a>02373     <span class="keywordflow">return</span> _sharesChromeWithPlatformWindow;
<a name="l02374"></a>02374 }
<a name="l02375"></a>02375 
<a name="l02376"></a>02376 <span class="comment">// Undo and Redo Support</span>
<a name="l02380"></a>02380 <span class="comment"></span>- (<a class="code" href="class_c_p_undo_manager.html" title="A general mechanism for user action &amp;quot;undo&amp;quot;.">CPUndoManager</a>)undoManager
<a name="l02381"></a>02381 {
<a name="l02382"></a>02382     <span class="comment">// If we&#39;ve ever created an undo manager, return it.</span>
<a name="l02383"></a>02383     <span class="keywordflow">if</span> (_undoManager)
<a name="l02384"></a>02384         <span class="keywordflow">return</span> _undoManager;
<a name="l02385"></a>02385 
<a name="l02386"></a>02386     <span class="comment">// If not, check to see if the document has one.</span>
<a name="l02387"></a>02387     var documentUndoManager = [[_windowController document] undoManager];
<a name="l02388"></a>02388 
<a name="l02389"></a>02389     <span class="keywordflow">if</span> (documentUndoManager)
<a name="l02390"></a>02390         <span class="keywordflow">return</span> documentUndoManager;
<a name="l02391"></a>02391 
<a name="l02392"></a>02392     <span class="comment">// If not, check to see if the delegate has one.</span>
<a name="l02393"></a>02393     <span class="keywordflow">if</span> (_delegateRespondsToWindowWillReturnUndoManagerSelector)
<a name="l02394"></a>02394         <span class="keywordflow">return</span> [_delegate windowWillReturnUndoManager:self];
<a name="l02395"></a>02395 
<a name="l02396"></a>02396     <span class="comment">// If not, create one.</span>
<a name="l02397"></a>02397     <span class="keywordflow">if</span> (!_undoManager)
<a name="l02398"></a>02398         _undoManager = [[<a class="code" href="class_c_p_undo_manager.html" title="A general mechanism for user action &amp;quot;undo&amp;quot;.">CPUndoManager</a> alloc] init];
<a name="l02399"></a>02399 
<a name="l02400"></a>02400     <span class="keywordflow">return</span> _undoManager;
<a name="l02401"></a>02401 }
<a name="l02402"></a>02402 
<a name="l02407"></a>02407 - (void)undo:(<span class="keywordtype">id</span>)aSender
<a name="l02408"></a>02408 {
<a name="l02409"></a>02409     [[<span class="keyword">self</span> undoManager] undo];
<a name="l02410"></a>02410 }
<a name="l02411"></a>02411 
<a name="l02416"></a>02416 - (void)redo:(<span class="keywordtype">id</span>)aSender
<a name="l02417"></a>02417 {
<a name="l02418"></a>02418     [[<span class="keyword">self</span> undoManager] redo];
<a name="l02419"></a>02419 }
<a name="l02420"></a>02420 
<a name="l02421"></a>02421 - (BOOL)containsPoint:(CGPoint)aPoint
<a name="l02422"></a>02422 {
<a name="l02423"></a>02423     <span class="keywordflow">return</span> <a class="code" href="_c_g_geometry_8j.html#a1a96c087c2dc31ab61c3c88a3c6ec7c5">CGRectContainsPoint</a>(_frame, aPoint);
<a name="l02424"></a>02424 }
<a name="l02425"></a>02425 
<a name="l02426"></a>02426 <span class="keyword">@end</span>
<a name="l02427"></a>02427 
<a name="l02428"></a>02428 <span class="keyword">@implementation </span><a class="code" href="class_c_p_window.html">CPWindow</a> (Deprecated)
<a name="l02429"></a>02429 
<a name="l02430"></a>02430 - (void)setFullBridge:(BOOL)shouldBeFullBridge
<a name="l02431"></a>02431 {
<a name="l02432"></a>02432     [<span class="keyword">self</span> setFullPlatformWindow:shouldBeFullBridge];
<a name="l02433"></a>02433 }
<a name="l02434"></a>02434 
<a name="l02435"></a>02435 - (BOOL)isFullBridge
<a name="l02436"></a>02436 {
<a name="l02437"></a>02437     <span class="keywordflow">return</span> [<span class="keyword">self</span> isFullPlatformWindow];
<a name="l02438"></a>02438 }
<a name="l02439"></a>02439 
<a name="l02440"></a>02440 <span class="comment">/*</span>
<a name="l02441"></a>02441 <span class="comment">    @ignore</span>
<a name="l02442"></a>02442 <span class="comment">*/</span>
<a name="l02443"></a>02443 - (CGPoint)convertBaseToBridge:(CGPoint)aPoint
<a name="l02444"></a>02444 {
<a name="l02445"></a>02445     <span class="keywordflow">return</span> [<span class="keyword">self</span> convertBaseToPlatformWindow:aPoint];
<a name="l02446"></a>02446 }
<a name="l02447"></a>02447 
<a name="l02448"></a>02448 <span class="comment">/*</span>
<a name="l02449"></a>02449 <span class="comment">    @ignore</span>
<a name="l02450"></a>02450 <span class="comment">*/</span>
<a name="l02451"></a>02451 - (CGPoint)convertBridgeToBase:(CGPoint)aPoint
<a name="l02452"></a>02452 {
<a name="l02453"></a>02453     <span class="keywordflow">return</span> [<span class="keyword">self</span> convertPlatformWindowToBase:aPoint];
<a name="l02454"></a>02454 }
<a name="l02455"></a>02455 
<a name="l02456"></a>02456 <span class="keyword">@end</span>
<a name="l02457"></a>02457 
<a name="l02458"></a>02458 var interpolate = function(fromValue, toValue, progress)
<a name="l02459"></a>02459 {
<a name="l02460"></a>02460     <span class="keywordflow">return</span> fromValue + (toValue - fromValue) * progress;
<a name="l02461"></a>02461 }
<a name="l02462"></a>02462 
<a name="l02463"></a>02463 <span class="comment">/* @ignore */</span>
<a name="l02464"></a>02464 <span class="keyword">@implementation </span>_CPWindowFrameAnimation : <a class="code" href="class_c_p_animation.html">CPAnimation</a>
<a name="l02465"></a>02465 {
<a name="l02466"></a>02466     <a class="code" href="class_c_p_window.html">CPWindow</a>    _window;
<a name="l02467"></a>02467     
<a name="l02468"></a>02468     CGRect      _startFrame;
<a name="l02469"></a>02469     CGRect      _targetFrame;
<a name="l02470"></a>02470 }
<a name="l02471"></a>02471 
<a name="l02472"></a>02472 - (id)initWithWindow:(<a class="code" href="class_c_p_window.html">CPWindow</a>)aWindow targetFrame:(CGRect)aTargetFrame
<a name="l02473"></a>02473 {
<a name="l02474"></a>02474     <span class="keyword">self</span> = [<span class="keyword">super</span> initWithDuration:0.2 animationCurve:CPAnimationLinear];
<a name="l02475"></a>02475     
<a name="l02476"></a>02476     <span class="keywordflow">if</span> (<span class="keyword">self</span>)
<a name="l02477"></a>02477     {
<a name="l02478"></a>02478         _window = aWindow;
<a name="l02479"></a>02479         
<a name="l02480"></a>02480         _targetFrame = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>(aTargetFrame);
<a name="l02481"></a>02481         _startFrame = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>([_window <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]);
<a name="l02482"></a>02482     }
<a name="l02483"></a>02483     
<a name="l02484"></a>02484     <span class="keywordflow">return</span> <span class="keyword">self</span>;
<a name="l02485"></a>02485 }
<a name="l02486"></a>02486 
<a name="l02487"></a>02487 - (void)startAnimation
<a name="l02488"></a>02488 {
<a name="l02489"></a>02489     [<span class="keyword">super</span> startAnimation];
<a name="l02490"></a>02490     
<a name="l02491"></a>02491     _window._isAnimating = YES;
<a name="l02492"></a>02492 }
<a name="l02493"></a>02493 
<a name="l02494"></a>02494 - (void)setCurrentProgress:(<span class="keywordtype">float</span>)aProgress
<a name="l02495"></a>02495 {
<a name="l02496"></a>02496     [<span class="keyword">super</span> setCurrentProgress:aProgress];
<a name="l02497"></a>02497     
<a name="l02498"></a>02498     var value = [<span class="keyword">self</span> currentValue];
<a name="l02499"></a>02499     
<a name="l02500"></a>02500     <span class="keywordflow">if</span> (value == 1.0)
<a name="l02501"></a>02501         _window._isAnimating = NO;
<a name="l02502"></a>02502     
<a name="l02503"></a>02503     [_window setFrameOrigin:CGPointMake(interpolate(CGRectGetMinX(_startFrame), CGRectGetMinX(_targetFrame), value), interpolate(CGRectGetMinY(_startFrame), CGRectGetMinY(_targetFrame), value))];
<a name="l02504"></a>02504     [_window setFrameSize:CGSizeMake(interpolate(CGRectGetWidth(_startFrame), CGRectGetWidth(_targetFrame), value), interpolate(CGRectGetHeight(_startFrame), CGRectGetHeight(_targetFrame), value))];
<a name="l02505"></a>02505 }
<a name="l02506"></a>02506 
<a name="l02507"></a>02507 <span class="keyword">@end</span>
<a name="l02508"></a>02508 
<a name="l02509"></a>02509 function _CPWindowFullPlatformWindowSessionMake(aWindowView, aContentRect, hasShadow, aLevel)
<a name="l02510"></a>02510 {
<a name="l02511"></a>02511     <span class="keywordflow">return</span> { windowView:aWindowView, contentRect:aContentRect, hasShadow:hasShadow, level:aLevel };
<a name="l02512"></a>02512 }
<a name="l02513"></a>02513 
<a name="l02514"></a>02514 CPStandardWindowShadowStyle = 0;
<a name="l02515"></a><a class="code" href="_c_p_window_8j.html#a48a0b3e87a6e0d291754b3837c486ce3">02515</a> <a class="code" href="_c_p_window_8j.html#a48a0b3e87a6e0d291754b3837c486ce3">CPMenuWindowShadowStyle</a>     = 1;
<a name="l02516"></a><a class="code" href="_c_p_window_8j.html#a1633d9fccde7867934e0bb28b4a106b2">02516</a> <a class="code" href="_c_p_window_8j.html#a1633d9fccde7867934e0bb28b4a106b2">CPPanelWindowShadowStyle</a>    = 2;
<a name="l02517"></a><a class="code" href="_c_p_window_8j.html#ad5f60717a3d8aeb512885e4e60803849">02517</a> <a class="code" href="_c_p_window_8j.html#ad5f60717a3d8aeb512885e4e60803849">CPCustomWindowShadowStyle</a>   = 3;
<a name="l02518"></a>02518 
<a name="l02519"></a>02519 
<a name="l02520"></a>02520 @<span class="keyword">import</span> <span class="stringliteral">&quot;_CPWindowView.j&quot;</span>
<a name="l02521"></a>02521 @<span class="keyword">import</span> <span class="stringliteral">&quot;_CPStandardWindowView.j&quot;</span>
<a name="l02522"></a>02522 @<span class="keyword">import</span> <span class="stringliteral">&quot;_CPDocModalWindowView.j&quot;</span>
<a name="l02523"></a>02523 @<span class="keyword">import</span> <span class="stringliteral">&quot;_CPHUDWindowView.j&quot;</span>
<a name="l02524"></a>02524 @<span class="keyword">import</span> <span class="stringliteral">&quot;_CPBorderlessWindowView.j&quot;</span>
<a name="l02525"></a>02525 @<span class="keyword">import</span> <span class="stringliteral">&quot;_CPBorderlessBridgeWindowView.j&quot;</span>
<a name="l02526"></a>02526 @<span class="keyword">import</span> <span class="stringliteral">&quot;CPDragServer.j&quot;</span>
<a name="l02527"></a>02527 @<span class="keyword">import</span> <span class="stringliteral">&quot;CPView.j&quot;</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
